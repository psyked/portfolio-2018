{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/checking-availability-in-office-365/","webpackCompilationHash":"db783472b1815e2f1864","result":{"data":{"site":{"siteMetadata":{"title":"James Ford","author":"James Ford"}},"markdownRemark":{"id":"4612bd3e-8094-5dd0-aa10-895024c6c7d7","html":"<blockquote>\n<p>Strange as it may seem this isn’t something that’s obvious to figure out, so allow me to save you half an hour of searching and just give you the answer.</p>\n</blockquote>\n<h3>Background</h3>\n<p>At the office we have a range of virtual and physical meeting rooms, but as good as off-the-shelf tools are, it’s still a laborious task to find an available room at a moment’s notice. It would be nice to tap into some APIs and be able to build our own custom tooling to make the availability more… visible.</p>\n<h3>The Answer; aka. How to do it:</h3>\n<ol>\n<li>First, get an API Access Token.</li>\n<li>Make a Graph API request with a JSON payload that outlines the target email addresses and the time period to check.</li>\n<li>Parse the response into usable data.</li>\n</ol>\n<h4>Getting an Access Token</h4>\n<p>Before starting you need an <em>Access Token,</em> which you can either get by following the steps in <a href=\"https://docs.microsoft.com/en-us/graph/auth-overview\">the official documentation</a>, or to make things simpler you can try out requests using the Graph Explorer tool:</p>\n<p><a href=\"https://developer.microsoft.com/graph/graph-explorer/\" title=\"https://developer.microsoft.com/graph/graph-explorer/\"><strong>Graph Explorer - Microsoft Graph</strong><br>\n_The Microsoft Graph explorer is a tool that lets you make requests and see responses against the Microsoft Graph_developer.microsoft.com</a><a href=\"https://developer.microsoft.com/graph/graph-explorer/\"></a></p>\n<h4>Making a Graph API request</h4>\n<p>Make a POST request to the <code>/me/calendar/getschedule</code> Graph API endpoint: <a href=\"https://graph.microsoft.com/beta/me/calendar/getschedule\">https://graph.microsoft.com/beta/me/calendar/getschedule</a>, — which is currently only available in beta — using a JSON request body that looks something like this:</p>\n<p>This request body includes the accounts for availability to be checked; <em>Schedules,</em> the start and end of the time period to check and the level of detail to look at; the <em>availaibilityViewInterval</em> — all of which affects the level of detail that comes back in the response.</p>\n<p>By way of example, we can make this request using CURL, like this:</p>\n<p>Or to make this same request with Javascript, like this:</p>\n<p>Or just use the Graph Explorer:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cab07a2db9cb85aa8ef8ea15fd9c7811/2f950/1*VQA7cjULHa_YPoxh1i1fWw.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAACCElEQVQoz41SyW4TQRCd//ESe+JtFlv2wRIxB0QiH8n/8AccuXDiB7hEQnwCioTYYkcT27N6pqfX6Z6FsiMjgR3BU2lUPd2vllel+a5zv/zmuh7AcZwojChlWZYJITjn4BBC5B5VVcGRMVbkOdwrKbVnF7Pr61fz+XwymVxdXr29eXPz+QPDLIpC13WDIPAPAH+9cTOGP91uXr+/fffxTmu327PZbDqd1uv1wWDwZfHV8d0sk4RgSqk6QB5QVSXmykvEFmdav9cbDu3xeAxRDGPguUEUxavVCiEET/M8V39i91PJqlBFrrSL2fMXLy8Hhqnr54ZpQZVJHEPzcRyjPYBQPAGt0xt07fGZ3qk3mtZoEoYhQimIBzpxBpKJsiirUyjLUut0zi3TGI2Guq6bhoFSpHLFBZdKZlIIULVQeZkfW1EWWr/fNwyj2+02mw3bspfh3QNe3sc/F9sfa+osou8ufzi2DXM8uobMHcuyWq1WrVYb2rbre2GSJDjFNEUY8YwXp9I+mtaEjI0GkGFUpmm6nk+55NlO50e1oTdoG+QBPy/2Bp/dUWlne/wmwyaookwIRIAQjIg0ITGiCeGYClg9BrUcjP1Nhk0CJWEtgxRvU7L2PD/xojQE8Y4Ff4IsspgwRKkXBQHyY7IVR+TdqE6SMykTCmTuh1uoGbMU5ve/ZLio/gV48wuOlMFzLHcNXAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1 VQA7cjULHa YPoxh1i1fWw\"\n        title=\"1 VQA7cjULHa YPoxh1i1fWw\"\n        src=\"/static/cab07a2db9cb85aa8ef8ea15fd9c7811/6ff5e/1*VQA7cjULHa_YPoxh1i1fWw.png\"\n        srcset=\"/static/cab07a2db9cb85aa8ef8ea15fd9c7811/135ae/1*VQA7cjULHa_YPoxh1i1fWw.png 300w,\n/static/cab07a2db9cb85aa8ef8ea15fd9c7811/34e8a/1*VQA7cjULHa_YPoxh1i1fWw.png 600w,\n/static/cab07a2db9cb85aa8ef8ea15fd9c7811/6ff5e/1*VQA7cjULHa_YPoxh1i1fWw.png 1200w,\n/static/cab07a2db9cb85aa8ef8ea15fd9c7811/2f950/1*VQA7cjULHa_YPoxh1i1fWw.png 1600w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n      />\n  </a>\n    </span></p>\n<p>Using the Graph Explorer UI</p>\n<h4>Parse the response</h4>\n<p>The response that comes back from the API will look something like this:</p>\n<p>This response contains a object for each Schedule requested, a representation of the schedule availability, and the available details of each item in the schedule.</p>\n<p>I find the <em>availabilityView</em> portion of the API response interesting — it’s a string that’s generated dynamically and represents the high-level availability for segments of time, beginning at the start time and split based on the initial <em>availabilityViewInterval</em> property of the POST request. The values in this string correspond with the following availability:</p>\n<p>0 = free<br>\n1 = tentative<br>\n2 = busy<br>\n3 = out of office<br>\n4 = working elsewhere</p>\n<p>This response can save you recursively parsing the <em>scheduleItems</em>, and you only have to split the string on each character to calculate availability.</p>\n<h3>Alternatives / the Explanation:</h3>\n<p>Checking calendars — whether it be for Meeting Rooms or for attendees — seems like it should be trivial task but it’s historically been quite complicated, because the APIs that expose the data needed to power this functionality usually requires read-level permissions from the calendar owner.</p>\n<p>When I first attempted to build this functionality, I assumed that I could simply check the public calendar of the 20-or-so meeting rooms and collate the data myself, but I quickly discovered that the API doesn’t work that way, and each of the meeting rooms would require me to have been granted explicit permissions to their calendar, which wasn’t going to happen.</p>\n<p>Fortunately, the <em>getSchedule</em> endpoint of the API exists under<code>/me/calendar</code> , so it just works, without the need for additional permissions. Counter-intuitive? Maybe. But it works, so we’ll overlook that.</p>\n<h3>Official Documentation</h3>\n<p>Here’s a link to the official documentation for this API endpoint:</p>\n<p><a href=\"https://docs.microsoft.com/en-us/graph/outlook-get-free-busy-schedule\" title=\"https://docs.microsoft.com/en-us/graph/outlook-get-free-busy-schedule\"><strong>Get free/busy schedule of users and resources (preview) - Microsoft Graph</strong><br>\n_In a work or school setting, a common scenario is to see when a user is free for meeting, or to browse the availability…_docs.microsoft.com</a><a href=\"https://docs.microsoft.com/en-us/graph/outlook-get-free-busy-schedule\"></a></p>\n<p>That’s all for now — so let’s go check schedules!</p>","timeToRead":3,"frontmatter":{"title":"Checking Availability in Office 365","date":"February 13, 2019","tags":["API","Office 365","Scheduling Software","Tech"],"url":"https://medium.com/comparethemarket/checking-availability-in-office-365-7a5d01690d65","image":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEEAgP/xAAUAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAFKewroZCv/xAAZEAEBAAMBAAAAAAAAAAAAAAACAwABEhH/2gAIAQEAAQUC6FK01MYOWNuhcPWpHYH/xAAWEQEBAQAAAAAAAAAAAAAAAAAAEkH/2gAIAQMBAT8BxL//xAAWEQEBAQAAAAAAAAAAAAAAAAAAEkH/2gAIAQIBAT8B1T//xAAeEAACAQQDAQAAAAAAAAAAAAAAAQIREhMhQVGBof/aAAgBAQAGPwK2wWSNz7E9+FMj3ocW+Cil8P/EABkQAAMBAQEAAAAAAAAAAAAAAAABESFhUf/aAAgBAQABPyHXS9q0eQMc45EbjxTg7JqDN8/T0jpKx//aAAwDAQACAAMAAAAQQM//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8QJWP/xAAXEQADAQAAAAAAAAAAAAAAAAAAAREx/9oACAECAQE/EMDSn//EAB0QAQEAAgIDAQAAAAAAAAAAAAERACFBUTFhcZH/2gAIAQEAAT8QFmg1UU98a/cUJtwzlsdJlCmkEAGECQ9YgUPaGjv7hIRo2CIZXcWL4b+5/9k=","aspectRatio":1.5296367112810707,"src":"/static/74dd5d04b486ccac6d21feb89ce9b7d8/30037/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg","srcSet":"/static/74dd5d04b486ccac6d21feb89ce9b7d8/10bdc/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg 158w,\n/static/74dd5d04b486ccac6d21feb89ce9b7d8/f4ab0/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg 315w,\n/static/74dd5d04b486ccac6d21feb89ce9b7d8/30037/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg 630w,\n/static/74dd5d04b486ccac6d21feb89ce9b7d8/9810d/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg 945w,\n/static/74dd5d04b486ccac6d21feb89ce9b7d8/ff2e4/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg 1260w,\n/static/74dd5d04b486ccac6d21feb89ce9b7d8/c82f6/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg 2400w","sizes":"(max-width: 630px) 100vw, 630px"}},"colors":null},"description":"How to check for meeting room availability using the (beta) Office 365 Graph API.","image_credit":"[rawpixel](https://unsplash.com/photos/mcLpPD36-2k?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/search/photos/meeting?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"prev":{"frontmatter":{"path":"/blog/inspired-by-open-source/","tags":["Open Source","Inner Source","Workflow Automation","Software Development","Tech"],"title":"Inspired by Open Source.","date":"2019-02-05T11:10:18.670Z","description":"Inner-sourcing at Compare the Market.","image":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAZNNSUjw/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxESMv/aAAgBAQABBQJgOgqCLUhnLA5kq8//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPwFH/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8BV//EABsQAAEEAwAAAAAAAAAAAAAAAAABAiEiEDFh/9oACAEBAAY/ApLJJZppezn/xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhQTH/2gAIAQEAAT8hvk3x7MeleZDVBRrGL6EN4GwfoR5DSq3ez//aAAwDAQACAAMAAAAQKM//xAAWEQEBAQAAAAAAAAAAAAAAAAAAATH/2gAIAQMBAT8Q1Yf/xAAVEQEBAAAAAAAAAAAAAAAAAAABAP/aAAgBAgEBPxACFf/EABsQAQADAQEBAQAAAAAAAAAAAAEAETEhQVGR/9oACAEBAAE/EGWBawqE4XcZySnVc398nzUkFUfJvQ1G2tZhYdUoeN3OzgtvWE//2Q==","aspectRatio":1.3333333333333333,"src":"/static/20c4b697a0c346f695f2a834f3c2bd5d/30037/1*RfedvHYZKGKGTxnkuNQ8gA.jpg","srcSet":"/static/20c4b697a0c346f695f2a834f3c2bd5d/10bdc/1*RfedvHYZKGKGTxnkuNQ8gA.jpg 158w,\n/static/20c4b697a0c346f695f2a834f3c2bd5d/f4ab0/1*RfedvHYZKGKGTxnkuNQ8gA.jpg 315w,\n/static/20c4b697a0c346f695f2a834f3c2bd5d/30037/1*RfedvHYZKGKGTxnkuNQ8gA.jpg 630w,\n/static/20c4b697a0c346f695f2a834f3c2bd5d/9810d/1*RfedvHYZKGKGTxnkuNQ8gA.jpg 945w,\n/static/20c4b697a0c346f695f2a834f3c2bd5d/ff2e4/1*RfedvHYZKGKGTxnkuNQ8gA.jpg 1260w,\n/static/20c4b697a0c346f695f2a834f3c2bd5d/989b1/1*RfedvHYZKGKGTxnkuNQ8gA.jpg 1600w","sizes":"(max-width: 630px) 100vw, 630px"}}}}},"next":{"frontmatter":{"path":"/blog/better-code-reviews/","tags":["Code Review","Software Development","Best Practices","Work","Collaboration"],"title":"Better Code Reviews.","date":"2019-09-03T06:40:11.169Z","description":"Reducing fear and friction in the review process.","image":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAACN0lEQVQoz6VT/08SYRjnb6q/oB9qWT/mWg3xK36JqagMZuFmLfvBNZwrETI3J6E1fkhKXC5cbh1tJ8rJlRQDWQqigBG87x3c4d1xPXLUpNHm1mfPPu9zd+/neT73vHcq+T+gqntXFEWO44oV8DwvSdJ5xSDDGKMzgMtSqQSPymVZksr1xZhhf+ZQHuVy+Rw+A4RRNp+FovU7g0/g6Qn7y/lFSIq4mIciCCnMMIxYFAsFNp3OvFtZ43nFRVmlLMDRWGpQP4UPkC9BuEKvZE7mWI5neZDF0rv2wDTsIgmyt7EtHInBfhiESlmAfQTd1XjfueK498kYPYyGU9+2Epv+xAadDHIMZ9+0zgSndrYjb1+v13RWxARB96ktIy/MY/7RMieHkjvbcSqwv0UnaHBBxsnBVd1uJBXfQ4rT6juL4qnY7fZeutzOIWGGsjnoeZmv2hYKwl7mu/GDIYkPKH+oU2tiWfbvzlSAvnb1JiRwsIfHSVyZFkSxUMiibOpHSiqJFou1oeG20rZG7PF4DYbRUyOSKAqictQsw36NhBkW2545qC/00yfP9f3mGrFi2+V6M/bQ8qdWpYoAvPE5MLlk9ay+h/zjOjE36/z9wVTEgiCseX09PcMXL1zR3TFr202tzYbWFkNz04BGrdeoB67f0HR3Deu6zepbOogF5xJGTHVgUOPoKBMMhpaXvZMTs+a74329I50dxraWIQhth3Go/4HJ+OjxuG1xwU2S1H48eXIi/PPHOCd+AWdJDLFgwuPUAAAAAElFTkSuQmCC","aspectRatio":1.3468559837728196,"src":"/static/12fc9c29fb437c7d950cf20433c76084/57090/1_e_GcUPHFZitEAn0DUrp7FA.png","srcSet":"/static/12fc9c29fb437c7d950cf20433c76084/d9446/1_e_GcUPHFZitEAn0DUrp7FA.png 158w,\n/static/12fc9c29fb437c7d950cf20433c76084/2f6e7/1_e_GcUPHFZitEAn0DUrp7FA.png 315w,\n/static/12fc9c29fb437c7d950cf20433c76084/57090/1_e_GcUPHFZitEAn0DUrp7FA.png 630w,\n/static/12fc9c29fb437c7d950cf20433c76084/4ace0/1_e_GcUPHFZitEAn0DUrp7FA.png 945w,\n/static/12fc9c29fb437c7d950cf20433c76084/fb0fe/1_e_GcUPHFZitEAn0DUrp7FA.png 1260w,\n/static/12fc9c29fb437c7d950cf20433c76084/abf84/1_e_GcUPHFZitEAn0DUrp7FA.png 1328w","sizes":"(max-width: 630px) 100vw, 630px"}}}}}}}}
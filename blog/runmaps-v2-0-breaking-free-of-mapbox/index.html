<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.1b66f2407ae8a1cede47.css">.tiles-module--image--1-ejc{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.tiles-module--imageContainer--9DUT4{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden}.tiles-module--wrapper--2oIOd{height:100%}.tiles-module--tile--2kwde{display:flex;flex:1 1;padding:2em;position:relative}.tiles-module--tile--2kwde a,.tiles-module--tile--2kwde a:active,.tiles-module--tile--2kwde a:hover,.tiles-module--tile--2kwde a:link,.tiles-module--tile--2kwde a:visited{color:#fcfcfd}.tiles-module--tile--2kwde h3,.tiles-module--tile--2kwde p{position:relative}.tiles-module--tile--2kwde h3{margin-top:0}.tiles-module--tile--2kwde .tiles-module--date--aIswY{border-top:1px solid #fcfcfd;display:inline-block}.tiles-module--tileContainer--3FpOW{width:100%;height:calc(33vw - 2em);max-height:16.875em;display:flex;flex-direction:row;justify-content:stretch;padding-bottom:0;margin-bottom:-1em}.tiles-module--blackout--ElFOE{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,61,.6)}.tags-module--tagsLabel--1AV4E{display:inline-block;margin-right:.5em}.tags-module--tag--3kCeK{display:inline-block;margin-right:.25em;white-space:nowrap}.tags-module--tag--3kCeK a{color:#2a2a37;text-decoration:none;border-bottom:1px dotted #2a2a37}.sourcepost-module--root--WEjHy{margin:1em -2em;padding:1em 2em;background:linear-gradient(90deg,#d0d0dc 0,#d0d0dc 8px,#eeeef2 0)}html{box-sizing:border-box}*,:after,:before{box-sizing:inherit}html{font-family:Roboto,sans-serif}h1,h2,h3,h4,h5,h6{font-family:Open Sans,sans-serif}img{max-width:100%}body{--bg:#fcfcfd;--fg:#a0b1ba;--text-color:#2a2a37;--link-color:#2962ff;--link-visited-color:#6200ea;margin:0;padding:0;background:var(--bg);color:var(--text-color);background-image:radial-gradient(var(--fg) 1px,transparent 0),radial-gradient(var(--fg) .5px,transparent 0),radial-gradient(var(--fg) .5px,transparent 0);background-size:1em 1em,1em 1em,1em 1em;background-position:0 0,0 -.5em,-.5em 0;-webkit-transition:background-color .3s ease-in,color .3s ease-in;transition:background-color .3s ease-in,color .3s ease-in}body.dark{--fg:#fcfcfd;--bg:#2a2a37;--text-color:#fcfcfd;--link-color:#ffeb3b;--link-visited-color:#ffc107;background-image:radial-gradient(#000 5%,transparent 0)}body a{-webkit-transition:color .3s ease-in;transition:color .3s ease-in}body a:active,body a:hover,body a:link{color:var(--link-color)}body a:visited{color:var(--link-visited-color)}html{font-size:16px;line-height:1.5}@media (min-width:320px){html{font-size:calc(16px + (200vw - 640px)/1046)}}@media (min-width:1366px){html{font-size:18px}}h1{font-size:2em}@media (min-width:20em){h1{font-size:calc(2em + (100vw - 20em)/50)}}@media (min-width:70em){h1{font-size:3em}}pre{overflow:scroll;background:#eeeef2;padding:.5em;margin:2em -.5em}main{display:block}.bodyContent{box-sizing:border-box;padding-left:16px;padding-right:16px}@media (min-width:320px){.bodyContent{padding-left:calc(7.14286vw - 6.85714px)}}@media (min-width:768px){.bodyContent{padding-left:48px}}@media (min-width:320px){.bodyContent{padding-right:calc(7.14286vw - 6.85714px)}}@media (min-width:768px){.bodyContent{padding-right:48px}}.bodyContainer{padding-left:calc((100vw - 60em)/2);padding-right:calc((100vw - 60em)/2)}.bodyContainer .inner{background:var(--bg);padding-top:1em;padding-bottom:1em;-webkit-transition:background .3s ease-in;transition:background .3s ease-in}figure{position:relative}figcaption a{--link-color:#ffeb3b;--link-visited-color:#ffc107}hr{background:var(--fg);border:0;height:1px;margin:0 auto;max-width:60em;overflow:visible;text-align:center;-webkit-transition:background .3s ease-in;transition:background .3s ease-in}@media (min-width:20em){hr{margin-top:calc(2em + (200vw - 40em)/50)}}@media (min-width:70em){hr{margin-top:4em}}@media (min-width:20em){hr{margin-bottom:calc(2em + (200vw - 40em)/50)}}@media (min-width:70em){hr{margin-bottom:4em}}hr:after{background:var(--bg);content:"\2022   \2022   \2022";display:inline-block;font-size:1.4em;padding:0 .4em;position:relative;top:-.7em;-webkit-transition:background .3s ease-in;transition:background .3s ease-in}hr:first-child{margin-top:0}hr:first-child:after{visibility:hidden}hr.endPost{background:#f0194b}hr.endPost:after{color:#f0194b;content:"END";font-size:.7em;top:-1.2em}p>.gatsby-resp-image-link{width:calc(50% - .5em);float:left}p>.gatsby-resp-image-link:first-child{margin-right:1em}p>.gatsby-resp-image-link:last-child:after{content:"";display:block;float:none}p>.gatsby-resp-image-link:only-child{float:none;width:100%;margin-right:0}p>img{max-width:100%;width:auto;margin:0 auto}blockquote{position:relative;padding:1em 3.33em;margin:1em 0;background:#e3f4fb;font-style:italic}blockquote:before{content:"\201C";top:0;left:.33em}blockquote:after,blockquote:before{font-style:normal;font-family:serif;font-weight:700;position:absolute;font-size:3em;color:#00b0f0}blockquote:after{content:"\201D";bottom:0;right:.33em}.external-profiles{display:flex;list-style:none;margin:0;padding:0}.external-profiles li{display:flex;flex:1 1 auto;margin:.5em;padding:1em .5em;text-align:center;border:.1em solid}.external-profiles li:first-child{margin-left:0}.external-profiles li:last-child{margin-right:0}.external-profiles li a{margin:auto}.external-profiles li svg{width:100%;height:2em}</style><meta name="generator" content="Gatsby 2.13.57"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><title data-react-helmet="true">RunMaps v2.0: Breaking free of Mapbox | James Ford</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:site" content="@psyked"/><meta data-react-helmet="true" name="twitter:creator"/><meta data-react-helmet="true" name="twitter:title" content="RunMaps v2.0: Breaking free of Mapbox"/><meta data-react-helmet="true" name="twitter:description" content="Replacing Mapbox API Vector Tiles with the OpenStreetMap Overpass API, for fun, profit and better output rendering."/><meta data-react-helmet="true" name="twitter:image" content="/static/f4b8dc3b12937f23de6775d40d0198b8/57090/1*XDK58wHmThVh24H1t35QNA.png"/><style data-styled="fwoAjb bWsevp gCcQCP dTObM fYrnZs biQWUe gxwioy gmXJPU bEtIXo UPOQL jHubZB jaMdoI" data-styled-version="4.3.2">
/* sc-component-id: Banner__Wrapper-hibpma-0 */
.bEtIXo{background:center center / cover hsl(240,100%,12%);position:relative;padding-top:calc(68px + 2em);padding-bottom:3em;padding-left:calc((100vw - 60em) / 2);padding-right:calc((100vw - 60em) / 2);}
/* sc-component-id: Banner__Overlay-hibpma-1 */
.jaMdoI{position:absolute;width:100%;height:100%;top:0px;left:0px;background:hsla(240,100%,12%,0.6);z-index:1;}
/* sc-component-id: Banner__ImageContainer-hibpma-2 */
.UPOQL{position:absolute;top:0;left:0;width:100%;padding-left:calc((100vw - 60em) / 2);padding-right:calc((100vw - 60em) / 2);height:100%;overflow:hidden;margin:0;}
/* sc-component-id: Banner__ImageWrapper-hibpma-3 */
.jHubZB{height:100%;}
/* sc-component-id: ThemeSwitch__SwitchWrapper-sc-1gyffmx-0 */
.fYrnZs{background-color:#ddd;border-radius:18px;cursor:pointer;display:inline-block;height:20px;padding:3px;position:relative;vertical-align:top;width:56px;box-sizing:content-box;}
/* sc-component-id: ThemeSwitch__Label-sc-1gyffmx-1 */
.gxwioy{background:#ffd700 none repeat scroll 0 0;border-radius:inherit;display:block;font-size:10px;height:inherit;position:relative;text-transform:uppercase;-webkit-transition:all 0.15s ease-out 0s;transition:all 0.15s ease-out 0s;} .gxwioy::before,.gxwioy::after{line-height:1;margin-top:-0.5em;position:absolute;top:50%;-webkit-transition:inherit;transition:inherit;}
/* sc-component-id: ThemeSwitch__Handle-sc-1gyffmx-2 */
.gmXJPU{background-color:#fff;border-radius:10px;height:18px;left:4px;position:absolute;top:4px;-webkit-transition:left 0.15s ease-out 0s;transition:left 0.15s ease-out 0s;width:18px;} .gmXJPU::before{background-color:#f9f9f9;border-radius:6px;content:'';height:12px;left:50%;margin:-6px 0 0 -6px;position:absolute;top:50%;width:12px;}
/* sc-component-id: ThemeSwitch__Input-sc-1gyffmx-3 */
.biQWUe{left:0;opacity:0;position:absolute;top:0;} .biQWUe:checked ~ .ThemeSwitch__Label-sc-1gyffmx-1{background:#eceeef none repeat scroll 0 0;} .biQWUe:checked ~ .ThemeSwitch__Handle-sc-1gyffmx-2{left:40px;}
/* sc-component-id: Header-sc-9dymkm-0 */
.fwoAjb{display:block;background:hsl(240,14%,19%);padding-left:calc((100vw - 60em) / 2);padding-right:calc((100vw - 60em) / 2);}
/* sc-component-id: Header__Nav-sc-9dymkm-1 */
.gCcQCP{max-width:60em;margin:0 auto;padding:0.5em 0.2em 0.5em 0.7em;width:100%;display:block;}
/* sc-component-id: Header__MenuLink-sc-9dymkm-2 */
.dTObM{margin-right:0.5em;padding:0.4em;} .dTObM,.dTObM a,.dTObM:link,.dTObM a:link,.dTObM:active,.dTObM a:active,.dTObM:visited,.dTObM a:visited,.dTObM:hover,.dTObM a:hover{color:hsl(240,14%,99%);} .dTObM:last-child{margin-right:0;} .dTObM.active{border-radius:0.15em;background-color:hsl(346,88%,52%);}
/* sc-component-id: Header__Wrapper-sc-9dymkm-3 */
.bWsevp{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 1em;}</style><link rel="shortcut icon" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/favicon-32x32.png"/><link rel="manifest" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/manifest.json"/><meta name="mobile-web-app-capable" content="yes"/><meta name="theme-color" content="#fff"/><meta name="application-name" content="psyked-gatsby"/><link rel="apple-touch-icon" sizes="57x57" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-icon-152x152.png"/><link rel="apple-touch-icon" sizes="167x167" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-icon-167x167.png"/><link rel="apple-touch-icon" sizes="180x180" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-icon-180x180.png"/><link rel="apple-touch-icon" sizes="1024x1024" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-icon-1024x1024.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/><meta name="apple-mobile-web-app-title" content="psyked-gatsby"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 1)" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-startup-image-320x460.png"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-startup-image-640x920.png"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-startup-image-640x1096.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-startup-image-750x1294.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 3)" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-startup-image-1182x2208.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 3)" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-startup-image-1242x2148.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 1)" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-startup-image-748x1024.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 1)" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-startup-image-768x1004.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-startup-image-1496x2048.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" href="/icons-e237b8d6b76bcf4b144afc76a1acd697/apple-touch-startup-image-1536x2008.png"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-d21912cb88e5ebf188aa.js"/><link as="script" rel="preload" href="/app-886abbf05f0ec019c166.js"/><link as="script" rel="preload" href="/styles-74e52cef0361d41342c9.js"/><link as="script" rel="preload" href="/12-ed465bf013ed7f438be4.js"/><link as="script" rel="preload" href="/2-67c9505def1db2f69257.js"/><link as="script" rel="preload" href="/1-0bdb452a928a12cbcf2c.js"/><link as="script" rel="preload" href="/webpack-runtime-f919c80a14ef0f956464.js"/><link as="fetch" rel="preload" href="/page-data/blog/runmaps-v2-0-breaking-free-of-mapbox/page-data.json" crossorigin="use-credentials"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    window.__theme = newTheme
    preferredTheme = newTheme
    document.body.className = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><header class="Header-sc-9dymkm-0 fwoAjb"><div class="Header__Wrapper-sc-9dymkm-3 bWsevp"><nav class="Header__Nav-sc-9dymkm-1 gCcQCP"><a exact="true" class="Header__MenuLink-sc-9dymkm-2 dTObM" href="/">Home</a><a class="Header__MenuLink-sc-9dymkm-2 dTObM" href="/blog/">Blog Archive</a><a class="Header__MenuLink-sc-9dymkm-2 dTObM" href="/speaking/">Public Speaking</a></nav><label class="switch ThemeSwitch__SwitchWrapper-sc-1gyffmx-0 fYrnZs"><input type="checkbox" class="ThemeSwitch__Input-sc-1gyffmx-3 biQWUe"/><span class="ThemeSwitch__Label-sc-1gyffmx-1 gxwioy"></span><span class="ThemeSwitch__Handle-sc-1gyffmx-2 gmXJPU"></span></label></div></header><main><header style="min-height:320px;background:#7A7A7A" class="Banner__Wrapper-hibpma-0 bEtIXo"><figure class="Banner__ImageContainer-hibpma-2 UPOQL"><div class="Banner__ImageWrapper-hibpma-3 jHubZB gatsby-image-wrapper" style="position:relative;overflow:hidden"><div style="width:100%;padding-bottom:54.166666666666664%"></div><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABq0lEQVQoz01S2XLbMAzU//9YnvrUTBOnbp3YSSzroijqIiV5g4VNjjWDAQSAi8WS2bZtWJYlWd/3GMcR/NZ1TXnG0zSl+Hq9ajzPs/5HnCwWvPfqQwhwziXgdED66KMRgL2sP57PYkNMxEld1ymo1plfQgLjxz6eoRGYnrksFmMjGV/v04dhwCQMvOvg8y+EOxMa2bMnDb2zznRNJjZZSRKRIYF5sLUWfWvQfx5VQ8pxuVzQNA2MMbpJBOMZBZzKC3xdYnsQN4J2AlDlZ5jDXgBa1HUtVqmvqpufhWnbtjcNCeI7i3D+RLAm6UOxCTjIaqYsYI8HWW9QhmRNMLKsigL16QNFWSrbLMhaVC80FbypsUk8y2rUKN7uLI3u4z9GyVPT4nTEy/NvfH0Lc2HY7F9vNTFd2QvldeixjIPqSLHjRU3TjN62MLI289S62u9w/PumGo7Ctnx9xtA7jGKZJoWN90E0WNPDjaa3LXUrqzq5bStsu/M3bJGjO71jPB1gfj2h2L2g3P1BRpq8eiuT8jxX2o9g8XHTc3ghmnEABzsnj18GmX9vqm8v8Q+8+VR6x5ZUigAAAABJRU5ErkJggg==" alt="" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/f4b8dc3b12937f23de6775d40d0198b8/d9446/1*XDK58wHmThVh24H1t35QNA.png 158w,
/static/f4b8dc3b12937f23de6775d40d0198b8/2f6e7/1*XDK58wHmThVh24H1t35QNA.png 315w,
/static/f4b8dc3b12937f23de6775d40d0198b8/57090/1*XDK58wHmThVh24H1t35QNA.png 630w,
/static/f4b8dc3b12937f23de6775d40d0198b8/4ace0/1*XDK58wHmThVh24H1t35QNA.png 945w,
/static/f4b8dc3b12937f23de6775d40d0198b8/ba299/1*XDK58wHmThVh24H1t35QNA.png 1200w" sizes="(max-width: 630px) 100vw, 630px" /><img loading="lazy" sizes="(max-width: 630px) 100vw, 630px" srcset="/static/f4b8dc3b12937f23de6775d40d0198b8/d9446/1*XDK58wHmThVh24H1t35QNA.png 158w,
/static/f4b8dc3b12937f23de6775d40d0198b8/2f6e7/1*XDK58wHmThVh24H1t35QNA.png 315w,
/static/f4b8dc3b12937f23de6775d40d0198b8/57090/1*XDK58wHmThVh24H1t35QNA.png 630w,
/static/f4b8dc3b12937f23de6775d40d0198b8/4ace0/1*XDK58wHmThVh24H1t35QNA.png 945w,
/static/f4b8dc3b12937f23de6775d40d0198b8/ba299/1*XDK58wHmThVh24H1t35QNA.png 1200w" src="/static/f4b8dc3b12937f23de6775d40d0198b8/57090/1*XDK58wHmThVh24H1t35QNA.png" alt="" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></figure><aside class="Banner__Overlay-hibpma-1 jaMdoI"></aside><div class="bodyContent" style="color:white;position:relative;z-index:2"><header><h1>RunMaps v2.0: Breaking free of Mapbox</h1></header><div><h2>Replacing Mapbox API Vector Tiles with the OpenStreetMap Overpass API, for fun, profit and better output rendering.</h2></div><aside>Published: <!-- -->26 May 2018</aside></div></header><div class="bodyContainer"><div class="inner"><div class="bodyContent"><div><p>In my previous post, <a href="https://medium.com/@psyked/generating-run-maps-with-node-js-52738014d3dc">‘Generating Run Maps with Node.js’</a>, I talked through the winding path that eventually led me to a place where I’d hooked up data from my activities on Fitbit with data from the Mapbox APIs and created a scalable vector image representation of my activity. It’s been a few weeks since that last post, I’ve had the opportunity to develop this project further, and now I’m going to talk about the next significant change; <em>dropping Mapbox.</em></p>
<h4>Why drop Mapbox?</h4>
<p><a href="https://www.mapbox.com/">Mapbox</a> is pretty neat, but it’s an entire ecosystem of tools geared towards delivering custom styled maps, and I wasn’t really using it correctly. All I actually wanted was GeoJSON data representing an area, and I got that by unpacking their APIs and then stitching and re-rendering the content myself. It was a rough solution based on what I understood at the time, but when I started reviewing the end result it became apparent that something wasn’t right with the data I was receiving.</p>
<p>Take a closer look at this image, and you’ll see a few problems — which I’ve outlined in red — that come with the approach of stitching together SVG tiles:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/f4b8dc3b12937f23de6775d40d0198b8/6ff5e/1*XDK58wHmThVh24H1t35QNA.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 54.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABq0lEQVQoz01S2XLbMAzU//9YnvrUTBOnbp3YSSzroijqIiV5g4VNjjWDAQSAi8WS2bZtWJYlWd/3GMcR/NZ1TXnG0zSl+Hq9ajzPs/5HnCwWvPfqQwhwziXgdED66KMRgL2sP57PYkNMxEld1ymo1plfQgLjxz6eoRGYnrksFmMjGV/v04dhwCQMvOvg8y+EOxMa2bMnDb2zznRNJjZZSRKRIYF5sLUWfWvQfx5VQ8pxuVzQNA2MMbpJBOMZBZzKC3xdYnsQN4J2AlDlZ5jDXgBa1HUtVqmvqpufhWnbtjcNCeI7i3D+RLAm6UOxCTjIaqYsYI8HWW9QhmRNMLKsigL16QNFWSrbLMhaVC80FbypsUk8y2rUKN7uLI3u4z9GyVPT4nTEy/NvfH0Lc2HY7F9vNTFd2QvldeixjIPqSLHjRU3TjN62MLI289S62u9w/PumGo7Ctnx9xtA7jGKZJoWN90E0WNPDjaa3LXUrqzq5bStsu/M3bJGjO71jPB1gfj2h2L2g3P1BRpq8eiuT8jxX2o9g8XHTc3ghmnEABzsnj18GmX9vqm8v8Q+8+VR6x5ZUigAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="1 XDK58wHmThVh24H1t35QNA"
        title="1 XDK58wHmThVh24H1t35QNA"
        src="/static/f4b8dc3b12937f23de6775d40d0198b8/6ff5e/1*XDK58wHmThVh24H1t35QNA.png"
        srcset="/static/f4b8dc3b12937f23de6775d40d0198b8/135ae/1*XDK58wHmThVh24H1t35QNA.png 300w,
/static/f4b8dc3b12937f23de6775d40d0198b8/34e8a/1*XDK58wHmThVh24H1t35QNA.png 600w,
/static/f4b8dc3b12937f23de6775d40d0198b8/6ff5e/1*XDK58wHmThVh24H1t35QNA.png 1200w"
        sizes="(max-width: 1200px) 100vw, 1200px"
      />
  </a>
    </span></p>
<p>Invalid / cropped area shapes from Mapbox API responses.</p>
<p>Those horizontal and vertical lines are the hard edges of what should be large shapes on the map. In the Mapbox API responses they’ve been cropped and the shapes from adjacent tiles overlap, a behaviour that’s based around the slicing up of the map data into Vector Tiles. That’s a problem for me because I actually want the unadulterated shapes, and I want the ability to style those shapes with semi-transparent colours, which I can’t do that if the shapes are overlapping.</p>
<h4>Alternative data sources 💡</h4>
<p>Fortunately I’ve already been exploring alternative sources of mapping data (more on that later) and deduced that I could probably get all of the data that I need directly from <a href="https://www.openstreetmap.org/">OpenStreetMap</a> — they even have a public (no login!) way of fetching that data directly from their servers: the <a href="https://wiki.openstreetmap.org/wiki/Overpass_API">Overpass API.</a></p>
<h4>Stepping stones 👟</h4>
<p>My efforts bumbling through code so far have left me with the ability to render a map using prefabricated GeoJSON data (aka. the data I get back from the Mapbox API), with the knowledge that I can generate simple GeoJSON objects using GPS coordinates from Fitbit data, and with a strategy for rendering the whole lot as SVG objects in a browser using D3.js.</p>
<h4>Cutting out Mapbox ✂️</h4>
<p>The existing [Mapbox-powered] rendering process looks like this:</p>
<ol>
<li>Load route data from Fitbit</li>
<li>Calculate the map centre point and bounds</li>
<li>Pass the bounds to the Mapbox JS library and let it fetch the MVT response</li>
<li>Unpack the MVT protobuff response and convert it to GeoJSON Tiles</li>
<li>Use D3 to render each GeoJSON tile as an SVG object</li>
<li>Use D3 to position each SVG tile correctly on-screen</li>
<li>Generate a GeoJSON representation of the route data from Fitbit</li>
<li>Use D3 to render the GeoJSON route over the top of the SVG tiles</li>
</ol>
<p>It works, but it’s a lot of back-and-forth between libraries and is more complex than I’d like. However, substituting Mapbox for the Overpass API gives me the following render process:</p>
<ol>
<li>Load route data from Fitbit</li>
<li>Calculate the map centre point and bounds</li>
<li>Pass the bounds to the Overpass API</li>
<li>Convert the API response to GeoJSON using the osmtogeojson library</li>
<li>Use D3 to render the single GeoJSON object as an SVG</li>
<li>Generate a GeoJSON representation of the route data from Fitbit</li>
<li>Use D3 to render the GeoJSON route over the top of the SVG tiles</li>
</ol>
<p>It’s arguably <em>one less</em> step than before, but the key gain here is that the GeoJSON response we get hasn’t been sliced up or cropped in any way, and there’s no tiles to worry about. Naturally there’s a lot that’s changed in the response data; Mapbox does a good job of curating its map information whereas the response from the Overpass API is a little more freeform, but the core details are still the same, which is all I need.</p>
<h4>Working with The Overpass API</h4>
<p>The <a href="https://wiki.openstreetmap.org/wiki/Overpass_API">Overpass API</a> allows queries to OpenStreetMap using Overpass QL, with an URL such as the one below, which takes bounding box coordinates that define a rectangular area and returns XML for all of the geography and amenities in the specified area.</p>
<p><a href="https://api.openstreetmap.org/api/0.6/map?bbox=-0.6428667113485337,52.58258428865147,-0.4982212886514664,52.727229711348535">https://api.openstreetmap.org/api/0.6/map?bbox=-0.6428667113485337,52.58258428865147,-0.4982212886514664,52.727229711348535</a></p>
<p>The output is an impressive 10Mb of XML data, so I’m not going to include it here, but it includes (a lot of) elements like this:</p>
<way id="250040917" visible="true" version="3" changeset="49132008" timestamp="2017-05-31T10:58:44Z" user="brianboru" uid="9065">  
  <nd ref="2565612416"/>  
  <nd ref="2565612409"/>  
  <nd ref="2565612404"/>  
  <nd ref="2565612402"/>  
  <nd ref="2565612400"/>  
  <nd ref="2565612399"/>  
  <nd ref="2565612397"/>  
  <nd ref="2565612395"/>  
  <nd ref="2565612394"/>  
  <nd ref="2565612392"/>  
  <nd ref="2565612391"/>  
  <nd ref="2565612390"/>  
  <nd ref="2565612388"/>  
  <nd ref="4880073434"/>  
  <tag k="highway" v="trunk_link"/>  
  <tag k="highways_england:area" v="6"/>  
  <tag k="oneway" v="yes"/>  
  <tag k="operator" v="Highways England"/>  
</way>
<p>Of course, that’s not GeoJSON data, which is what I really want. Fortunately there’s already a Javascript module that makes things easy called <strong>osmtogeojson</strong> which I can integrate using the following code:</p>
<p>import osmtogeojson from "osmtogeojson";<br>
import axios from "axios";</p>
<p>const data = await axios<br>
.get(`<a href="https://api.openstreetmap.org/api/0.6/map?bbox=$%7Bx0%7D,$%7By0%7D,$%7Bx1%7D,$%7By1%7D%5C%60">https://api.openstreetmap.org/api/0.6/map?bbox=${x0},${y0},${x1},${y1}\`</a>)<br>
.then(({ request: { <em>responseXML</em> } }) => responseXML);</p>
<p>const osmgeojsondata = osmtogeojson(data);</p>
<p>What does the combined output look like? Much the same, fortunately, except there’s no cropping or tiling mess to worry about. Hurrah! 🎉</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c4fe29e81d3367d9d8cf20d6626cc61a/d40c8/1*TB_SVvse2S-qdgFHkrsDxA.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABDUlEQVQoz1XRTXKDMAwFYO5/NRbZcgIWgSRACEkKLf3wm2amWnhkSe/HcvVT4vV6PR6P+/3+fD73fVfJ+V1Csq7rtm26WwlFA5XqXkIJRdrv91tb66uEoopkHMcgw17JVJVcJMSnaVqWZZ5nJzu32+16vcpRy8P7DyzihMhYou97o5JhGNBhmUoYwBKxKm92iX/E5/MZxjRxRiRkL5cLlq7ruECqRazKVijjA5bj1nNFBwbTNE1d123bouCIPlIDFUBWTfOz1blEWOicTqeAYz5vPJSzp88O57/AraKehXkIFwSimfnDNnC2F/95ZE4s2ZYEki9X5u3lAOczs7bk+VVImh4MSSpfla4ThesvkoVCg8Ed6VMAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="1 TB SVvse2S qdgFHkrsDxA"
        title="1 TB SVvse2S qdgFHkrsDxA"
        src="/static/c4fe29e81d3367d9d8cf20d6626cc61a/6ff5e/1*TB_SVvse2S-qdgFHkrsDxA.png"
        srcset="/static/c4fe29e81d3367d9d8cf20d6626cc61a/135ae/1*TB_SVvse2S-qdgFHkrsDxA.png 300w,
/static/c4fe29e81d3367d9d8cf20d6626cc61a/34e8a/1*TB_SVvse2S-qdgFHkrsDxA.png 600w,
/static/c4fe29e81d3367d9d8cf20d6626cc61a/6ff5e/1*TB_SVvse2S-qdgFHkrsDxA.png 1200w,
/static/c4fe29e81d3367d9d8cf20d6626cc61a/79a4a/1*TB_SVvse2S-qdgFHkrsDxA.png 1800w,
/static/c4fe29e81d3367d9d8cf20d6626cc61a/d40c8/1*TB_SVvse2S-qdgFHkrsDxA.png 2000w"
        sizes="(max-width: 1200px) 100vw, 1200px"
      />
  </a>
    </span></p>
<p>Finally, much improved mapping data, without any cropping weirdness!</p>
<hr>
<p>Next up, I’m going to take these SVGs and apply some snazzy styling to make the output look 👌.</p></div><hr class="endPost"/><aside class="sourcepost-module--root--WEjHy">This article was originally published at <a href="https://medium.com/@psyked/runmaps-v2-0-breaking-free-of-mapbox-dbe3c3ca1a01">https://medium.com/@psyked/runmaps-v2-0-breaking-free-of-mapbox-dbe3c3ca1a01</a></aside><aside><span class="tags-module--tagsLabel--1AV4E">Tagged as:</span><span class="tags-module--tag--3kCeK"><a href="/tag/mapbox">Mapbox</a><span>, </span></span><span class="tags-module--tag--3kCeK"><a href="/tag/openstreetmap">Openstreetmap</a><span>, </span></span><span class="tags-module--tag--3kCeK"><a href="/tag/side-project">Side Project</a><span>, </span></span><span class="tags-module--tag--3kCeK"><a href="/tag/d3js">D3js</a><span>, </span></span><span class="tags-module--tag--3kCeK"><a href="/tag/geojson">Geojson</a></span></aside></div></div></div><aside class="tiles-module--tileContainer--3FpOW"><section class="tiles-module--tile--2kwde"><a href="/blog/runmaps-3-colour-schemes-and-labels/"><aside class="tiles-module--imageContainer--9DUT4"><div class="tiles-module--wrapper--2oIOd gatsby-image-wrapper" style="position:relative;overflow:hidden"><div style="width:100%;padding-bottom:50%"></div><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABiUlEQVQozy1S227jIBDN///aSqtWWjVNm9Y25s4MMwND1MfFTiUkLuJwblxUqw4CdCl+kUClNAapUu91DD6G0jypuhv/4sK79KqKrcMEXg6w1segn58Osvp0a72AuN6RNeT2ldqnh6vBvzu+5Potx6N0EtTLnObtrjgZeERGw+F7h1dsjrrLdK+0I5gKe6NE4EhK79Bb+WWeyKlzLqZIrakl39BLtg1iZ1BByC4Fk/y2r7eU15C3UvbJ+iv7BNNzTXkT8IKBi5Nkk1uj2+zyGe1SMYS0RHbYqOsJfjxYx8ygPMmxmxTfpIRadgaLbru9/vH3Kyfv5gbvlj5QMrVTds62oO16BKhnyJk/Md4lOS5bDvdl/chui+gymkjX2s0YMJ6eRUAaHJkNnsFANn1glNuZZTLwT7QA20jrtAbNorgj7el59jllj1FPzcQCs21WKm1njZ6NJyuSA65LfEt1Ly1hS7PI2fbl/AzPqIh7pQYgngRRMLHP7Ke3SoU5dC3YQpRchBas17z+B99OKm0F29kdAAAAAElFTkSuQmCC" alt="" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/7deb149afe31e8b997ed26eb3755d633/d9446/1*w4ALp74pUYzMQl3Nt8p3aA.png 158w,
/static/7deb149afe31e8b997ed26eb3755d633/2f6e7/1*w4ALp74pUYzMQl3Nt8p3aA.png 315w,
/static/7deb149afe31e8b997ed26eb3755d633/57090/1*w4ALp74pUYzMQl3Nt8p3aA.png 630w,
/static/7deb149afe31e8b997ed26eb3755d633/4ace0/1*w4ALp74pUYzMQl3Nt8p3aA.png 945w,
/static/7deb149afe31e8b997ed26eb3755d633/ba299/1*w4ALp74pUYzMQl3Nt8p3aA.png 1200w" sizes="(max-width: 630px) 100vw, 630px" /><img loading="lazy" sizes="(max-width: 630px) 100vw, 630px" srcset="/static/7deb149afe31e8b997ed26eb3755d633/d9446/1*w4ALp74pUYzMQl3Nt8p3aA.png 158w,
/static/7deb149afe31e8b997ed26eb3755d633/2f6e7/1*w4ALp74pUYzMQl3Nt8p3aA.png 315w,
/static/7deb149afe31e8b997ed26eb3755d633/57090/1*w4ALp74pUYzMQl3Nt8p3aA.png 630w,
/static/7deb149afe31e8b997ed26eb3755d633/4ace0/1*w4ALp74pUYzMQl3Nt8p3aA.png 945w,
/static/7deb149afe31e8b997ed26eb3755d633/ba299/1*w4ALp74pUYzMQl3Nt8p3aA.png 1200w" src="/static/7deb149afe31e8b997ed26eb3755d633/57090/1*w4ALp74pUYzMQl3Nt8p3aA.png" alt="" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></aside><div class="tiles-module--blackout--ElFOE"></div><h3>RunMaps 3: Colour Schemes and Labels</h3><p>Now it&#x27;s time to pick up where we left the original development; improving the visuals by adding place labels and map markers.</p><p class="tiles-module--date--aIswY">26 May 2018</p></a></section><section class="tiles-module--tile--2kwde"><a href="/blog/openfaas-like-lamba-but-open/"><div class="tiles-module--blackout--ElFOE"></div><h3>OpenFaaS: Like AWS Lambda, but Open Source and built on top of Docker</h3><p></p><p class="tiles-module--date--aIswY">26 Mar 2018</p></a></section></aside></main><footer id="footer"></footer></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/runmaps-v2-0-breaking-free-of-mapbox/";window.webpackCompilationHash="e51baebdd56585b5ad6a";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-886abbf05f0ec019c166.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-d21912cb88e5ebf188aa.js"],"component---src-templates-tag-list-template-js":["/component---src-templates-tag-list-template-js-dd829e9c7251e74958d3.js"],"component---src-pages-blog-jsx":["/component---src-pages-blog-jsx-674eeb24afbc1f9215c8.js"],"component---src-pages-index-jsx":["/component---src-pages-index-jsx-be612368a7f6d8505633.js"],"component---src-pages-projects-jsx":["/component---src-pages-projects-jsx-23f3247daac47e6192e5.js"],"component---src-pages-speaking-jsx":["/component---src-pages-speaking-jsx-aceb5c5ad81f89864be2.js"],"component---src-pages-tags-jsx":["/component---src-pages-tags-jsx-b7fc11f2770e778d5254.js"]};/*]]>*/</script><script src="/webpack-runtime-f919c80a14ef0f956464.js" async=""></script><script src="/1-0bdb452a928a12cbcf2c.js" async=""></script><script src="/2-67c9505def1db2f69257.js" async=""></script><script src="/12-ed465bf013ed7f438be4.js" async=""></script><script src="/styles-74e52cef0361d41342c9.js" async=""></script><script src="/app-886abbf05f0ec019c166.js" async=""></script><script src="/component---src-templates-blog-post-js-d21912cb88e5ebf188aa.js" async=""></script></body></html>
<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.a57798ad4d86c86d7e4b.css">.tiles-module--image--1-ejc{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.tiles-module--imageContainer--9DUT4{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden}.tiles-module--wrapper--2oIOd{height:100%}.tiles-module--tile--2kwde{display:-webkit-flex;display:flex;-webkit-flex:1 1;flex:1 1;padding:2em;position:relative}.tiles-module--tile--2kwde a{color:#fcfcfd;text-decoration:none}.tiles-module--tile--2kwde h3,.tiles-module--tile--2kwde p{position:relative}.tiles-module--tile--2kwde h3{border-bottom:.1em dotted #fcfcfd;margin-top:0}.tiles-module--tile--2kwde .tiles-module--date--aIswY{border-top:1px solid #fcfcfd;display:inline-block}.tiles-module--tileContainer--3FpOW{width:100%;height:calc(33vw - 2em);display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-justify-content:stretch;justify-content:stretch;margin-top:2em;margin-bottom:2em}.tiles-module--blackout--ElFOE{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,61,.6)}.tags-module--tagsLabel--1AV4E{display:inline-block;margin-right:.5em}.tags-module--tag--3kCeK{display:inline-block;margin-right:.25em;white-space:nowrap}.tags-module--tag--3kCeK a{color:#2a2a37;text-decoration:none;border-bottom:1px dotted #2a2a37}.sourcepost-module--root--WEjHy{margin:1em -2em;padding:1em 2em;background:linear-gradient(90deg,#d0d0dc 0,#d0d0dc 8px,#eeeef2 0)}.header-module--menuLink--17w_4{margin-right:.5em;color:#fcfcfd}.header-module--active--2pIok{color:#f0194b}.header-module--root--3b321{background:#2a2a37;padding:.5em}html{box-sizing:border-box}*,:after,:before{box-sizing:inherit}html{font-family:Roboto,sans-serif}h1,h2,h3,h4,h5,h6{font-family:Open Sans,sans-serif}img{max-width:100%}body{margin:0;padding:0;background:#fcfcfd}html{font-size:16px;line-height:1.5}@media (min-width:320px){html{font-size:calc(16px + (200vw - 640px)/1046)}}@media (min-width:1366px){html{font-size:18px}}h1{font-size:2em}@media (min-width:20em){h1{font-size:calc(2em + (100vw - 20em)/50)}}@media (min-width:70em){h1{font-size:3em}}pre{overflow:scroll;background:#eeeef2;padding:.5em;margin:2em -.5em}.bodyContent{box-sizing:border-box;margin:0 auto;max-width:60em;padding-left:16px;padding-right:16px}@media (min-width:320px){.bodyContent{padding-left:calc(7.14286vw - 6.85714px)}}@media (min-width:768px){.bodyContent{padding-left:48px}}@media (min-width:320px){.bodyContent{padding-right:calc(7.14286vw - 6.85714px)}}@media (min-width:768px){.bodyContent{padding-right:48px}}hr{background:#2a2a37;border:0;height:1px;margin:0 auto;max-width:60em;overflow:visible;text-align:center}@media (min-width:20em){hr{margin-top:calc(2em + (200vw - 40em)/50)}}@media (min-width:70em){hr{margin-top:4em}}@media (min-width:20em){hr{margin-bottom:calc(2em + (200vw - 40em)/50)}}@media (min-width:70em){hr{margin-bottom:4em}}hr:after{background:#fcfcfd;content:"\2022   \2022   \2022";display:inline-block;font-size:1.4em;padding:0 .4em;position:relative;top:-.7em}hr.endPost{background:#f0194b}hr.endPost:after{color:#f0194b;content:"END";font-size:.7em;top:-1.2em}p>.gatsby-resp-image-link{width:calc(50% - .5em);float:left}p>.gatsby-resp-image-link:first-child{margin-right:1em}p>.gatsby-resp-image-link:last-child:after{content:"";display:block;float:none}p>.gatsby-resp-image-link:only-child{float:none;width:100%;margin-right:0}p>img{max-width:100%;width:auto;margin:0 auto}blockquote{position:relative;padding:1em 3.33em;margin:1em 0;background:#e3f4fb;font-style:italic}blockquote:before{content:"\201C";top:0;left:.33em}blockquote:after,blockquote:before{font-style:normal;font-family:serif;font-weight:700;position:absolute;font-size:3em;color:#00b0f0}blockquote:after{content:"\201D";bottom:0;right:.33em}.external-profiles{display:-webkit-flex;display:flex;list-style:none;margin:0;padding:0}.external-profiles li{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto;margin:.5em;padding:1em .5em;text-align:center;border:.1em solid}.external-profiles li:first-child{margin-left:0}.external-profiles li:last-child{margin-right:0}.external-profiles li a{margin:auto}.external-profiles li svg{width:100%;height:2em}</style><meta name="generator" content="Gatsby 2.7.1"/><title data-react-helmet="true">Checking Availability in Office 365 | James Ford</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:site" content="@psyked"/><meta data-react-helmet="true" name="twitter:creator"/><meta data-react-helmet="true" name="twitter:title" content="Checking Availability in Office 365"/><meta data-react-helmet="true" name="twitter:description" content="How to check for meeting room availability using the (beta) Office 365 Graph API."/><style data-styled="gRjVAE hlSqCg" data-styled-version="4.2.0">
/* sc-component-id: Banner__Wrapper-hibpma-0 */
.gRjVAE{background:center center / cover $border;position:relative;padding-top:2em;padding-bottom:3em;}
/* sc-component-id: Banner__Overlay-hibpma-1 */
.hlSqCg{position:absolute;width:100%;height:100%;top:0px;left:0px;background:rgba($border,0.6);}</style><link as="script" rel="preload" href="/component---src-templates-blog-post-js-ceb71cbd593f5997e7c9.js"/><link as="script" rel="preload" href="/app-523774c7d59d91decc83.js"/><link as="script" rel="preload" href="/11-136b333296f119c7f06b.js"/><link as="script" rel="preload" href="/1-3e750456ca4431761d32.js"/><link as="script" rel="preload" href="/styles-febc33b797b051cb2e7a.js"/><link as="script" rel="preload" href="/webpack-runtime-cca15437c1eb04731a99.js"/><link as="fetch" rel="preload" href="/static/d/749/path---blog-checking-availability-in-office-365-dcc-2c2-q99oJ65zZ04FQPFPRHtvqqZfDs.json" crossorigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div><header class="header-module--root--3b321"><nav class="bodyContent"><a class="header-module--menuLink--17w_4" href="/">Home</a><a class="header-module--menuLink--17w_4" href="/blog/">Blog Archive</a><a class="header-module--menuLink--17w_4" href="/speaking/">Public Speaking</a></nav></header><main><header class="Banner__Wrapper-hibpma-0 gRjVAE"><aside class="Banner__Overlay-hibpma-1 hlSqCg"></aside><div class="bodyContent" style="color:white;position:relative"><header><h1>Checking Availability in Office 365</h1></header><div><h2>How to check for meeting room availability using the (beta) Office 365 Graph API.</h2></div><aside>Published: <!-- -->13 Feb 2019</aside></div></header><div class="bodyContent"><div><blockquote>
<p>Strange as it may seem this isn’t something that’s obvious to figure out, so allow me to save you half an hour of searching and just give you the answer.</p>
</blockquote>
<p><a
    class="gatsby-resp-image-link"
    href="/static/74dd5d04b486ccac6d21feb89ce9b7d8/d7d8f/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 630px;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 65.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEEAgP/xAAUAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAFKewroZCv/xAAZEAEBAAMBAAAAAAAAAAAAAAACAwABEhH/2gAIAQEAAQUC6FK01MYOWNuhcPWpHYH/xAAWEQEBAQAAAAAAAAAAAAAAAAAAEkH/2gAIAQMBAT8BxL//xAAWEQEBAQAAAAAAAAAAAAAAAAAAEkH/2gAIAQIBAT8B1T//xAAeEAACAQQDAQAAAAAAAAAAAAAAAQIREhMhQVGBof/aAAgBAQAGPwK2wWSNz7E9+FMj3ocW+Cil8P/EABkQAAMBAQEAAAAAAAAAAAAAAAABESFhUf/aAAgBAQABPyHXS9q0eQMc45EbjxTg7JqDN8/T0jpKx//aAAwDAQACAAMAAAAQQM//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8QJWP/xAAXEQADAQAAAAAAAAAAAAAAAAAAAREx/9oACAECAQE/EMDSn//EAB0QAQEAAgIDAQAAAAAAAAAAAAERACFBUTFhcZH/2gAIAQEAAT8QFmg1UU98a/cUJtwzlsdJlCmkEAGECQ9YgUPaGjv7hIRo2CIZXcWL4b+5/9k='); background-size: cover; display: block;"
    ></span>
    <img
        class="gatsby-resp-image-image"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;"
        alt="1 xxKgPqB6Hkmx6y3gJS8LwA"
        title=""
        src="/static/74dd5d04b486ccac6d21feb89ce9b7d8/8854f/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg"
        srcset="/static/74dd5d04b486ccac6d21feb89ce9b7d8/3b5c6/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg 158w,
/static/74dd5d04b486ccac6d21feb89ce9b7d8/434a1/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg 315w,
/static/74dd5d04b486ccac6d21feb89ce9b7d8/8854f/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg 630w,
/static/74dd5d04b486ccac6d21feb89ce9b7d8/3cac0/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg 945w,
/static/74dd5d04b486ccac6d21feb89ce9b7d8/0646d/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg 1260w,
/static/74dd5d04b486ccac6d21feb89ce9b7d8/d7d8f/1*xxKgPqB6Hkmx6y3gJS8LwA.jpg 2400w"
        sizes="(max-width: 630px) 100vw, 630px"
      />
  </span>
  </a></p>
<p>Photo by <a href="https://unsplash.com/photos/mcLpPD36-2k?utm_source=unsplash&#x26;utm_medium=referral&#x26;utm_content=creditCopyText">rawpixel</a> on <a href="https://unsplash.com/search/photos/meeting?utm_source=unsplash&#x26;utm_medium=referral&#x26;utm_content=creditCopyText">Unsplash</a></p>
<h3>Background</h3>
<p>At the office we have a range of virtual and physical meeting rooms, but as good as off-the-shelf tools are, it’s still a laborious task to find an available room at a moment’s notice. It would be nice to tap into some APIs and be able to build our own custom tooling to make the availability more… visible.</p>
<h3>The Answer; aka. How to do it:</h3>
<ol>
<li>First, get an API Access Token.</li>
<li>Make a Graph API request with a JSON payload that outlines the target email addresses and the time period to check.</li>
<li>Parse the response into usable data.</li>
</ol>
<h4>Getting an Access Token</h4>
<p>Before starting you need an <em>Access Token,</em> which you can either get by following the steps in <a href="https://docs.microsoft.com/en-us/graph/auth-overview">the official documentation</a>, or to make things simpler you can try out requests using the Graph Explorer tool:</p>
<p><a href="https://developer.microsoft.com/graph/graph-explorer/" title="https://developer.microsoft.com/graph/graph-explorer/"><strong>Graph Explorer - Microsoft Graph</strong><br>
_The Microsoft Graph explorer is a tool that lets you make requests and see responses against the Microsoft Graph_developer.microsoft.com</a><a href="https://developer.microsoft.com/graph/graph-explorer/"></a></p>
<h4>Making a Graph API request</h4>
<p>Make a POST request to the <code>/me/calendar/getschedule</code> Graph API endpoint: <a href="https://graph.microsoft.com/beta/me/calendar/getschedule">https://graph.microsoft.com/beta/me/calendar/getschedule</a>, — which is currently only available in beta — using a JSON request body that looks something like this:</p>
<p>This request body includes the accounts for availability to be checked; <em>Schedules,</em> the start and end of the time period to check and the level of detail to look at; the <em>availaibilityViewInterval</em> — all of which affects the level of detail that comes back in the response.</p>
<p>By way of example, we can make this request using CURL, like this:</p>
<p>Or to make this same request with Javascript, like this:</p>
<p>Or just use the Graph Explorer:</p>
<p><a
    class="gatsby-resp-image-link"
    href="/static/cab07a2db9cb85aa8ef8ea15fd9c7811/2f950/1*VQA7cjULHa_YPoxh1i1fWw.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 630px;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAACCElEQVQoz41SyW4TQRCd//ESe+JtFlv2wRIxB0QiH8n/8AccuXDiB7hEQnwCioTYYkcT27N6pqfX6Z6FsiMjgR3BU2lUPd2vllel+a5zv/zmuh7AcZwojChlWZYJITjn4BBC5B5VVcGRMVbkOdwrKbVnF7Pr61fz+XwymVxdXr29eXPz+QPDLIpC13WDIPAPAH+9cTOGP91uXr+/fffxTmu327PZbDqd1uv1wWDwZfHV8d0sk4RgSqk6QB5QVSXmykvEFmdav9cbDu3xeAxRDGPguUEUxavVCiEET/M8V39i91PJqlBFrrSL2fMXLy8Hhqnr54ZpQZVJHEPzcRyjPYBQPAGt0xt07fGZ3qk3mtZoEoYhQimIBzpxBpKJsiirUyjLUut0zi3TGI2Guq6bhoFSpHLFBZdKZlIIULVQeZkfW1EWWr/fNwyj2+02mw3bspfh3QNe3sc/F9sfa+osou8ufzi2DXM8uobMHcuyWq1WrVYb2rbre2GSJDjFNEUY8YwXp9I+mtaEjI0GkGFUpmm6nk+55NlO50e1oTdoG+QBPy/2Bp/dUWlne/wmwyaookwIRIAQjIg0ITGiCeGYClg9BrUcjP1Nhk0CJWEtgxRvU7L2PD/xojQE8Y4Ff4IsspgwRKkXBQHyY7IVR+TdqE6SMykTCmTuh1uoGbMU5ve/ZLio/gV48wuOlMFzLHcNXAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    ></span>
    <img
        class="gatsby-resp-image-image"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;"
        alt="1 VQA7cjULHa YPoxh1i1fWw"
        title=""
        src="/static/cab07a2db9cb85aa8ef8ea15fd9c7811/b2a12/1*VQA7cjULHa_YPoxh1i1fWw.png"
        srcset="/static/cab07a2db9cb85aa8ef8ea15fd9c7811/0c596/1*VQA7cjULHa_YPoxh1i1fWw.png 158w,
/static/cab07a2db9cb85aa8ef8ea15fd9c7811/8844e/1*VQA7cjULHa_YPoxh1i1fWw.png 315w,
/static/cab07a2db9cb85aa8ef8ea15fd9c7811/b2a12/1*VQA7cjULHa_YPoxh1i1fWw.png 630w,
/static/cab07a2db9cb85aa8ef8ea15fd9c7811/feebe/1*VQA7cjULHa_YPoxh1i1fWw.png 945w,
/static/cab07a2db9cb85aa8ef8ea15fd9c7811/c6d2c/1*VQA7cjULHa_YPoxh1i1fWw.png 1260w,
/static/cab07a2db9cb85aa8ef8ea15fd9c7811/2f950/1*VQA7cjULHa_YPoxh1i1fWw.png 1600w"
        sizes="(max-width: 630px) 100vw, 630px"
      />
  </span>
  </a></p>
<p>Using the Graph Explorer UI</p>
<h4>Parse the response</h4>
<p>The response that comes back from the API will look something like this:</p>
<p>This response contains a object for each Schedule requested, a representation of the schedule availability, and the available details of each item in the schedule.</p>
<p>I find the <em>availabilityView</em> portion of the API response interesting — it’s a string that’s generated dynamically and represents the high-level availability for segments of time, beginning at the start time and split based on the initial <em>availabilityViewInterval</em> property of the POST request. The values in this string correspond with the following availability:</p>
<p>0 = free<br>
1 = tentative<br>
2 = busy<br>
3 = out of office<br>
4 = working elsewhere</p>
<p>This response can save you recursively parsing the <em>scheduleItems</em>, and you only have to split the string on each character to calculate availability.</p>
<h3>Alternatives / the Explanation:</h3>
<p>Checking calendars — whether it be for Meeting Rooms or for attendees — seems like it should be trivial task but it’s historically been quite complicated, because the APIs that expose the data needed to power this functionality usually requires read-level permissions from the calendar owner.</p>
<p>When I first attempted to build this functionality, I assumed that I could simply check the public calendar of the 20-or-so meeting rooms and collate the data myself, but I quickly discovered that the API doesn’t work that way, and each of the meeting rooms would require me to have been granted explicit permissions to their calendar, which wasn’t going to happen.</p>
<p>Fortunately, the <em>getSchedule</em> endpoint of the API exists under<code>/me/calendar</code> , so it just works, without the need for additional permissions. Counter-intuitive? Maybe. But it works, so we’ll overlook that.</p>
<h3>Official Documentation</h3>
<p>Here’s a link to the official documentation for this API endpoint:</p>
<p><a href="https://docs.microsoft.com/en-us/graph/outlook-get-free-busy-schedule" title="https://docs.microsoft.com/en-us/graph/outlook-get-free-busy-schedule"><strong>Get free/busy schedule of users and resources (preview) - Microsoft Graph</strong><br>
_In a work or school setting, a common scenario is to see when a user is free for meeting, or to browse the availability…_docs.microsoft.com</a><a href="https://docs.microsoft.com/en-us/graph/outlook-get-free-busy-schedule"></a></p>
<p>That’s all for now — so let’s go check schedules!</p></div><hr class="endPost"/><aside class="sourcepost-module--root--WEjHy">This article was originally published at <a href="https://medium.com/comparethemarket/checking-availability-in-office-365-7a5d01690d65">https://medium.com/comparethemarket/checking-availability-in-office-365-7a5d01690d65</a></aside><aside><span class="tags-module--tagsLabel--1AV4E">Tagged as:</span><span class="tags-module--tag--3kCeK"><a href="/tag/api">API</a><span>, </span></span><span class="tags-module--tag--3kCeK"><a href="/tag/office-365">Office 365</a><span>, </span></span><span class="tags-module--tag--3kCeK"><a href="/tag/scheduling-software">Scheduling Software</a><span>, </span></span><span class="tags-module--tag--3kCeK"><a href="/tag/tech">Tech</a></span></aside></div><aside class="bodyContent tiles-module--tileContainer--3FpOW"><section class="tiles-module--tile--2kwde"><a href="/speaking/make-your-tools-work"><div class="tiles-module--blackout--ElFOE"></div><h3>Make Your Tools Work</h3><p>Specifically, make your tools work for you.</p><p class="tiles-module--date--aIswY">01 Jan 1970</p></a></section><section class="tiles-module--tile--2kwde"><a href="/blog/inspired-by-open-source/"><div class="tiles-module--blackout--ElFOE"></div><h3>Inspired by Open Source.</h3><p>Inner-sourcing at Compare the Market.</p><p class="tiles-module--date--aIswY">05 Feb 2019</p></a></section></aside></main><footer id="footer"></footer></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"blog-checking-availability-in-office-365-dcc","path":"/blog/checking-availability-in-office-365/"};window.dataPath="749/path---blog-checking-availability-in-office-365-dcc-2c2-q99oJ65zZ04FQPFPRHtvqqZfDs";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-523774c7d59d91decc83.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-ceb71cbd593f5997e7c9.js"],"component---src-templates-tag-list-template-js":["/component---src-templates-tag-list-template-js-c735563daaace564cd21.js"],"component---src-pages-blog-jsx":["/component---src-pages-blog-jsx-5991289efbc91f642db0.js"],"component---src-pages-index-jsx":["/component---src-pages-index-jsx-67a21b35f9ec9a4411d9.js"],"component---src-pages-speaking-jsx":["/component---src-pages-speaking-jsx-7564fbf9ad5033a58d45.js"],"component---src-pages-tags-jsx":["/component---src-pages-tags-jsx-e2841dbac4f3e179db90.js"],"pages-manifest":["/pages-manifest-84868e2c1883453a5bdc.js"]};/*]]>*/</script><script src="/webpack-runtime-cca15437c1eb04731a99.js" async=""></script><script src="/styles-febc33b797b051cb2e7a.js" async=""></script><script src="/1-3e750456ca4431761d32.js" async=""></script><script src="/11-136b333296f119c7f06b.js" async=""></script><script src="/app-523774c7d59d91decc83.js" async=""></script><script src="/component---src-templates-blog-post-js-ceb71cbd593f5997e7c9.js" async=""></script></body></html>
webpackJsonp([0x7d70442a8a30],{1148:function(a,e){a.exports={data:{site:{siteMetadata:{title:"Psyked: James' Web Development website",author:"James Ford"}},markdownRemark:{id:"/Users/James/Repositories/portfolio-2018/src/posts/generating-run-maps-with-node-js/index.md absPath of file >>> MarkdownRemark",html:'<h2>Hacking away at the Mapbox and Fitbit dataÂ APIs</h2>\n<h4>The big ideaÂ ğŸ’¡</h4>\n<p>I joined <a href="https://www.deeson.co.uk/">Deeson</a> as a remote worker about six months ago, and to accompany this change in lifestyle I decided to take up running. Fast-forward a couple of months and Iâ€™ve signed myself up for my first half-marathon.</p>\n<p>Working on the assumption that I do actually manage to survive the half-marathon I thought it would be a great idea to create a posterâ€Šâ€”â€Šsomething individual and uniqueâ€Šâ€”â€Što commemorate the occasion.</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*6DVOeqd4gqvUCZuiyABEWA-447365bb848b9d468932d5d225945f2d-162e3.jpeg"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHuVkqqoE0B/8QAFRABAQAAAAAAAAAAAAAAAAAAIDH/2gAIAQEAAQUCgh//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAcEAEAAgEFAAAAAAAAAAAAAAABABEhECBRYZH/2gAIAQEAAT8hVyykuyB2+6ctlT//2gAMAwEAAgADAAAAEGfff//EABYRAQEBAAAAAAAAAAAAAAAAABABMf/aAAgBAwEBPxAun//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAECAQE/EGP/xAAeEAEAAgEEAwAAAAAAAAAAAAABESEAEDFBUWFx0f/aAAgBAQABPxDsQvxgamnrICl9y0bMBl2KU+6JCwxjMl8TsYCCs//Z\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 6DVOeqd4gqvUCZuiyABEWA"\n        title=""\n        src="/static/1*6DVOeqd4gqvUCZuiyABEWA-447365bb848b9d468932d5d225945f2d-af57e.jpeg"\n        srcset="/static/1*6DVOeqd4gqvUCZuiyABEWA-447365bb848b9d468932d5d225945f2d-847f7.jpeg 158w,\n/static/1*6DVOeqd4gqvUCZuiyABEWA-447365bb848b9d468932d5d225945f2d-93973.jpeg 315w,\n/static/1*6DVOeqd4gqvUCZuiyABEWA-447365bb848b9d468932d5d225945f2d-af57e.jpeg 630w,\n/static/1*6DVOeqd4gqvUCZuiyABEWA-447365bb848b9d468932d5d225945f2d-162e3.jpeg 741w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*VOci63C1vQigp1wImXF1HA-27088dafbc1fd0956acbdf920008cb66-9e99b.jpeg"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQADAAAAAAAAAAAAAAAAAAECBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB7EJag1AmIP/EABcQAQEBAQAAAAAAAAAAAAAAAAAREDH/2gAIAQEAAQUCd2qqq//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEABj8CH//EABkQAAMAAwAAAAAAAAAAAAAAAAABERAhMf/aAAgBAQABPyEc0eKhp2kFQos//9oADAMBAAIAAwAAABADKP8A/8QAFREBAQAAAAAAAAAAAAAAAAAAIDH/2gAIAQMBAT8Qo//EABURAQEAAAAAAAAAAAAAAAAAAAEg/9oACAECAQE/EEj/xAAdEAEAAgICAwAAAAAAAAAAAAABABEhMRBhQaGx/9oACAEBAAE/ECzu/UoZBG01x3zUCyDliRoVPlC1z5n/2Q==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 VOci63C1vQigp1wImXF1HA"\n        title=""\n        src="/static/1*VOci63C1vQigp1wImXF1HA-27088dafbc1fd0956acbdf920008cb66-af57e.jpeg"\n        srcset="/static/1*VOci63C1vQigp1wImXF1HA-27088dafbc1fd0956acbdf920008cb66-847f7.jpeg 158w,\n/static/1*VOci63C1vQigp1wImXF1HA-27088dafbc1fd0956acbdf920008cb66-93973.jpeg 315w,\n/static/1*VOci63C1vQigp1wImXF1HA-27088dafbc1fd0956acbdf920008cb66-af57e.jpeg 630w,\n/static/1*VOci63C1vQigp1wImXF1HA-27088dafbc1fd0956acbdf920008cb66-9e99b.jpeg 750w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>As inspiration, hereâ€™s an example route from Fitbit andÂ Strava</p>\n<p>The idea I have in mind is one that features the actual route data and statistics from my run; much like an improved version of the route snapshots offered by the Fitbit or Strava apps, and combining that with overlaid graphics and the actual maps.</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*h_DCwrhsaZFXv6inFmkWKw-ef736245fca19eb7cacb52bcfca68c23-3a143.jpeg"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 105.4375%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAVABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB62azaCwCwf/EABgQAQADAQAAAAAAAAAAAAAAAAEAEBEh/9oACAEBAAEFAuw7S5B2mFf/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAbEAACAwADAAAAAAAAAAAAAAABEQAQIbHB8P/aAAgBAQABPyF6fEaBkUfU9BWgNIgoV//aAAwDAQACAAMAAAAQb8cB/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8QIf/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESFREEFxgcH/2gAIAQEAAT8QQFauqGJgXYD3hYKVa+YAr6gJRE3hLhaSNkCo9u+P/9k=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 h DCwrhsaZFXv6inFmkWKw"\n        title=""\n        src="/static/1*h_DCwrhsaZFXv6inFmkWKw-ef736245fca19eb7cacb52bcfca68c23-af57e.jpeg"\n        srcset="/static/1*h_DCwrhsaZFXv6inFmkWKw-ef736245fca19eb7cacb52bcfca68c23-847f7.jpeg 158w,\n/static/1*h_DCwrhsaZFXv6inFmkWKw-ef736245fca19eb7cacb52bcfca68c23-93973.jpeg 315w,\n/static/1*h_DCwrhsaZFXv6inFmkWKw-ef736245fca19eb7cacb52bcfca68c23-af57e.jpeg 630w,\n/static/1*h_DCwrhsaZFXv6inFmkWKw-ef736245fca19eb7cacb52bcfca68c23-28cf9.jpeg 945w,\n/static/1*h_DCwrhsaZFXv6inFmkWKw-ef736245fca19eb7cacb52bcfca68c23-0d474.jpeg 1260w,\n/static/1*h_DCwrhsaZFXv6inFmkWKw-ef736245fca19eb7cacb52bcfca68c23-3a143.jpeg 1600w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Early early sketchbook ideas for the finalÂ output.</p>\n<p>With an idea set, itâ€™s time to start working on some code. Obviously as a one-off poster it would be more efficient to have a tool like Illustrator to make something special, but Iâ€™m more interested in the coding and development side of things, so Iâ€™m going to build the whole project in Javascript.</p>\n<h4>Getting route dataÂ ğŸ“</h4>\n<p>Iâ€™m not really interested in plotting a route manually. Iâ€™m already using my Fitbit to track my routes, so it makes sense to try and use that existing data. As it transpires thatâ€™s pretty easy because Fitbit allows you to export your own data as a <a href="https://en.wikipedia.org/wiki/Training_Center_XML">TCX file.</a></p>\n<p>That TCX file is fairly easy to read with Javascript, itâ€™s just an XML document (<a href="https://developer.garmin.com/downloads/connect-api/sample_file.tcx">example here</a>) which can be loaded using the <a href="https://github.com/Leonidas-from-XIV/node-xml2js">xml2js</a> package. From that file I can extract the geolocation coordinates from the run, one data point for each minute of the run.</p>\n<h4>Validating the extracted routeÂ data</h4>\n<p>Next I need to look at rendering that data in a meaningful way. To sanity check the data Iâ€™ve extracted from the TCX file, Iâ€™m going to combine it with an existing mapping tool and see what it looks like.</p>\n<h4>Getting static imageÂ maps</h4>\n<p>Iâ€™ve ended up using <a href="https://www.mapbox.com/">Mapbox</a> as my data source for the actual maps. For a first pass I want to try something simple, like grabbing a static image of the relevant part of my route. Mapbox has a static maps API, which means that all I really need to do is specify a centerpoint for the map and a zoom level, and it will return me an image for that location.</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*T_fIgHIHIG_QsVIhmWPxeA-fd75db68a1c8d8d1aa0ecdaf5ee985a9-74a12.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAABi0lEQVQ4y21USW7DMAzU///YAs0tdSxusnvtiLRkxjEgOFq4zXCYYiYstG2Gte9NhIhra4qFJ3xxH9/PVRjmTLDrRsdt69buHPdztWY5VlGDUV844BvPtyvKmRtVLjjoEb6J6sU6Hx3F2+vh7HaoFrDt1n/if8N8Od8aWVNRviHsTJKAgfaMs3l19uFfbonpFA5WOuHNsLkpG0k0lXqkaspM6q2Kp2jH1fn78cAPmp2YRM1IKuJpcW/h366NLF8/j8zq/s4TkmNBcy4H8Vp6CITuzn/OTTgDwklVXPqRiF51hQqume3QjSYNtYAahKmheK3Ez2Vdax2MemaEXKna0F3X8xgJVDHzw3F5wZnCJsgvlYmFt6mkNEwANkal75G8EvkgsHrPS25Sj5fIu0zCHL4xQq5tH2k+O+kkj/Z2FCQEaAAI/xy3iGcjOCcBxYSIynP5xV9FCM4VLkPkKFO6wvatJYVrMASjlVYxmc07xTvnudZXnpgQQEdItaJY+IPO/SACcGAMA8CBKP8BhUtzkqrNIyoAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 T fIgHIHIG QsVIhmWPxeA"\n        title=""\n        src="/static/1*T_fIgHIHIG_QsVIhmWPxeA-fd75db68a1c8d8d1aa0ecdaf5ee985a9-082ce.png"\n        srcset="/static/1*T_fIgHIHIG_QsVIhmWPxeA-fd75db68a1c8d8d1aa0ecdaf5ee985a9-c7cb1.png 158w,\n/static/1*T_fIgHIHIG_QsVIhmWPxeA-fd75db68a1c8d8d1aa0ecdaf5ee985a9-93041.png 315w,\n/static/1*T_fIgHIHIG_QsVIhmWPxeA-fd75db68a1c8d8d1aa0ecdaf5ee985a9-082ce.png 630w,\n/static/1*T_fIgHIHIG_QsVIhmWPxeA-fd75db68a1c8d8d1aa0ecdaf5ee985a9-c4006.png 945w,\n/static/1*T_fIgHIHIG_QsVIhmWPxeA-fd75db68a1c8d8d1aa0ecdaf5ee985a9-85e68.png 1260w,\n/static/1*T_fIgHIHIG_QsVIhmWPxeA-fd75db68a1c8d8d1aa0ecdaf5ee985a9-38b38.png 1890w,\n/static/1*T_fIgHIHIG_QsVIhmWPxeA-fd75db68a1c8d8d1aa0ecdaf5ee985a9-74a12.png 2000w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>An example static map downloaded fromÂ Mapbox.</p>\n<p>I passed the extracted TCX route data through the <a href="https://github.com/manuelbieh/Geolib">Node.js geolib library</a>, which calculated the exact centre from my list of coordinates and the appropriate zoom level for a map that contained those coordinates, and received the image shown above. No actual â€˜routeâ€™ overlay yet, but that proves that the extracted geolocation data from the TCX file is accurate.</p>\n<p>Unfortunately, for generating maps that are of a high enough quality to print as an A2 poster, static bitmaps arenâ€™t good enough. What I really need is vector-based maps instead of image tiles, so thatâ€™s where Iâ€™m going next.</p>\n<h4>Moving to vector mapÂ tiles</h4>\n<p>In addition to its Static Maps API, Mapbox also has an endpoint for Vector Tiles data, which is where it starts to get interesting. Vector-based maps should scale flawlessly to whatever size are needed for printing, and if I could render these map tiles then adding new markers to those maps and plotting the route itself should be a much simpler process. Much simpler than accurately drawing an overlay over a static background image, anyway.</p>\n<h4>Vector MapÂ data</h4>\n<p>Bitmap images work great at the resolution theyâ€™re designed for, but they donâ€™t scale well. And although I could theoretically generate bitmap images at the correct resolution to print at 300 DPI, Iâ€™d rather have a proper vector output to go for really high-quality professional printingâ€Šâ€”â€Šsomething like a Encapsulated PostScript (EPS) sounds ideal, but Scalable Vector Graphics (SVG) would also do fine.</p>\n<p>Taking a look at Mapboxâ€™s own Javascript-powered browser based library <a href="https://www.mapbox.com/mapbox-gl-js/api/">(Mapbox GL JS)</a>, what theyâ€™re doing is rendering the maps to an HTML Canvas element and getting the source data from the Vector Tiles API. Dynamically rendering the map tiles to a canvas element makes the output highly performant, but it also means that the output is also well insulated and impossible for me to simply extract from any existing renderer. The challenge then is to take whatever data the Vector Tiles API provides and convert that into something I can work withâ€Šâ€”â€Šessentially, my own stripped-down renderer.</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*GaVXn5RUz46EqJe2UMUs5w-638363cb65292461d42ba0ab96ee39c3-74a12.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 44.95%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAAB7ElEQVQozz1STWvVQBTN/xXpVjcKChYXIi4FlyIKgooLi7joSmzVl/edl6+ZzFcmk0yStquWCsebeW0Xh2GGueeec+6NWlfD6hJGJDBmA61T6KqAbwRGyzEQ2rqCswKOzs7u0dYc4zhgGEZcXl3h+vofnGsRNY2CIiKr1qj1hogK9JahMTliVmBV5hibFBeE0RZwhgfiCX1nMXiHs6ENaBuNyIgcrePQqoAiOJVAVVskSuLVyuHgz4B3qcasEogrhlbtMJgdzuuc/m7pb7JvYhg6Uh11jSQLIlh09GD5GjOu8DZx+FY0+JLWeLNu8GLl8Xje4/2uwefM4GOikKkK3qSoVU6OWEA0ZdHe5NTVlB115oLhcOHxKPaYJ6RA7HDZcqylxPNlh4MTj3unI45Ki3MSYmQOK4lYZqTwLuR90JOlpZA4Lg2ezD0ezHq8XA34mjkwLfCjMLj/u8f3TMOTsyCEXIZcTUVDoQlPUw6kBMO3WHKGT5nFU1J5uOjxOinwbFUG8ofxgA9pg7EuKabqrm4S40KGN5dblT3Z3skiFP2iLA29cXuCv+YIP2m1TgsJLRkMDY0xASkEKRRBra5TRIpnmCZ9S+hpZTQVeprchatCvt5O9hStD8MZ3TkXWKwrxMsSm4TIqYFVBM3wH0oXhrjIu7PmAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 GaVXn5RUz46EqJe2UMUs5w"\n        title=""\n        src="/static/1*GaVXn5RUz46EqJe2UMUs5w-638363cb65292461d42ba0ab96ee39c3-082ce.png"\n        srcset="/static/1*GaVXn5RUz46EqJe2UMUs5w-638363cb65292461d42ba0ab96ee39c3-c7cb1.png 158w,\n/static/1*GaVXn5RUz46EqJe2UMUs5w-638363cb65292461d42ba0ab96ee39c3-93041.png 315w,\n/static/1*GaVXn5RUz46EqJe2UMUs5w-638363cb65292461d42ba0ab96ee39c3-082ce.png 630w,\n/static/1*GaVXn5RUz46EqJe2UMUs5w-638363cb65292461d42ba0ab96ee39c3-c4006.png 945w,\n/static/1*GaVXn5RUz46EqJe2UMUs5w-638363cb65292461d42ba0ab96ee39c3-85e68.png 1260w,\n/static/1*GaVXn5RUz46EqJe2UMUs5w-638363cb65292461d42ba0ab96ee39c3-38b38.png 1890w,\n/static/1*GaVXn5RUz46EqJe2UMUs5w-638363cb65292461d42ba0ab96ee39c3-74a12.png 2000w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>A snapshot of the Mapbox GL JSÂ output.</p>\n<p>If I was interested enough, Iâ€™d go and read something like the <a href="https://github.com/mapbox/vector-tile-spec/tree/master/2.1">Vector Tiles specification,</a> but thatâ€™s a bit hardcore. Instead Iâ€™m going to just start hacking away, and see where it all ends up.</p>\n<h4>Unpacking MVT data responses</h4>\n<p>Foolishly I assumed that the API response from Mapbox would be comprehensible with normal Javascript. I was expecting to see something like an SVG or GeoJSON data response, but instead I get this:</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*1V_ZlowZLN69-ItwtSDOmg-dc3a4ffbd5eac76faa397093a65f30f0-74a12.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 33%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABC0lEQVQY022QWW7EIBBEff9DjmEYHJt938HpSLHyk6dSqWnRFLBxKYUyTKgLKikEZwoaUhitnXXO2BQTABbzo5RTzjHGLdYSSgmwKLnXNFoevazRZl9zrAHeV58TWnX1X8017nvOub1e+74jcIzfFz3ON7kwScZEkFLZWq+1l7I632JqIZQQKoQak53b5kMf4yTEICwR5ggbSi09PD0k+TBCwnXpr1NBh/PMhDkvKLb7YczJjkNgrOkRuYiMBS6SlM26Yl3SOmodlPJKFeeac07Iv2EIP+DOO1KUesarVA5CjKkhzFJnh9f/AH6vBZpjbMZa+MzWWi6FIHR9qBayeD9qHUDvsGn9Bxz0DbWbjxmdRHOjAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 1V ZlowZLN69 ItwtSDOmg"\n        title=""\n        src="/static/1*1V_ZlowZLN69-ItwtSDOmg-dc3a4ffbd5eac76faa397093a65f30f0-082ce.png"\n        srcset="/static/1*1V_ZlowZLN69-ItwtSDOmg-dc3a4ffbd5eac76faa397093a65f30f0-c7cb1.png 158w,\n/static/1*1V_ZlowZLN69-ItwtSDOmg-dc3a4ffbd5eac76faa397093a65f30f0-93041.png 315w,\n/static/1*1V_ZlowZLN69-ItwtSDOmg-dc3a4ffbd5eac76faa397093a65f30f0-082ce.png 630w,\n/static/1*1V_ZlowZLN69-ItwtSDOmg-dc3a4ffbd5eac76faa397093a65f30f0-c4006.png 945w,\n/static/1*1V_ZlowZLN69-ItwtSDOmg-dc3a4ffbd5eac76faa397093a65f30f0-85e68.png 1260w,\n/static/1*1V_ZlowZLN69-ItwtSDOmg-dc3a4ffbd5eac76faa397093a65f30f0-38b38.png 1890w,\n/static/1*1V_ZlowZLN69-ItwtSDOmg-dc3a4ffbd5eac76faa397093a65f30f0-74a12.png 2000w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Ugh. Total gibberish.</p>\n<p>Fortunately this is actually explained in <a href="https://www.mapbox.com/vector-tiles/specification/#format">the documentation</a>. The API response is apparently an encoded <a href="https://github.com/google/protobuf">Protobuf</a> format, which is a clever way of serializing structured data. So all Iâ€™ve got to do is deserialize that data and it should be comprehensible. Thereâ€™s actually a fascinatingly complex amount of optimisation that goes into the MVT format used by Mapbox, which Iâ€™d recommend reading more about in <a href="https://www.mapbox.com/vector-tiles/specification/#encoding-geom">the documentation,</a> if youâ€™re so inclined.</p>\n<p>Naturally thereâ€™s an existing library (or two or three) to help with that conversion process from MVT to GeoJSON. After a few false starts I ended up using the <a href="https://github.com/mapbox/vt2geojson">vt2geojson</a> library, which automagically unpacks the API responses and delivers them as GeoJSON objects that I can work with in Javascript. <a href="https://gist.github.com/psyked/e531f079f2462637fc976274a283141b">(See an example decoded response as a Gist here.)</a></p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*2j5g04Q8vM4jGUalM5Wl-w-1069b695642a6436853d43ef81fda048-85ae7.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 59.75%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABS0lEQVQoz4WSzXaEIAyF5/1fbtbdjIgiv44ECKCiNtOuW3MOgUW+cOHmEVNarF3HMTOGxhhrlZTTNJ3ndd7Fo9aqB/keRLCmrRRbLQUxH+d1Gw9aZrRCqPKeV+89QEYMIcRIKZWy3cBBhWmUsXsFxrq+10pxzj/ahaZWN7BXnuDU93EY+DhaS0KE1tTEhXAHgwIhZGQscj6IwVkjxGiM0touS27t/A+Oc1yU3xOumAEQfAkxx1AAqvdbKe0/uG37zMEOc85ryVcIR60X4glw1PW4kb3VzfVhfGkIobW9reVKkfK216vggSlT15wbwEYekpIYd6rc9w+MkGfpgDOcZ/iYFAGAnELEaarOVqo5f4bmd25+D5+baQcNI31Y14WOvRgzWvec05A5Z5/P+PUVfuA/ZKd30sqgEElKSf44Rz6RYc7Nw4DLsv715m9jBLP3Gc5bpwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 2j5g04Q8vM4jGUalM5Wl w"\n        title=""\n        src="/static/1*2j5g04Q8vM4jGUalM5Wl-w-1069b695642a6436853d43ef81fda048-082ce.png"\n        srcset="/static/1*2j5g04Q8vM4jGUalM5Wl-w-1069b695642a6436853d43ef81fda048-c7cb1.png 158w,\n/static/1*2j5g04Q8vM4jGUalM5Wl-w-1069b695642a6436853d43ef81fda048-93041.png 315w,\n/static/1*2j5g04Q8vM4jGUalM5Wl-w-1069b695642a6436853d43ef81fda048-082ce.png 630w,\n/static/1*2j5g04Q8vM4jGUalM5Wl-w-1069b695642a6436853d43ef81fda048-c4006.png 945w,\n/static/1*2j5g04Q8vM4jGUalM5Wl-w-1069b695642a6436853d43ef81fda048-85e68.png 1260w,\n/static/1*2j5g04Q8vM4jGUalM5Wl-w-1069b695642a6436853d43ef81fda048-85ae7.png 1600w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>The resulting decoded GeoJSON data object from a MVT response.</p>\n<p>The decoded GeoJSON data has an amazing level of detail to it and is composed of geometry information, identifying labels, categorisation and a few other thingsâ€Šâ€”â€Ševerything you could need to render a map.</p>\n<h4>Plotting a basic map withÂ D3</h4>\n<p>At last, I have enough data to start drawing something useful. The big question isâ€¦ how? What Iâ€™ve got is a load of data points which are all longitude and latitude coordinates, but that doesnâ€™t naturally translate into normal x and y coordinates for rendering on screen.</p>\n<p>Itâ€™s unlikely to really matter at the scales my map is going to be drawn, but projecting geography to a 2D plane is not quite as straightforward as you might imagine.</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*A5Z3N8iqF_7MP3L4y-rtOQ-65567b100f4cae8e379e8697a2683b2a-58fd0.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABqUlEQVQoz0VSP+tBYRR+4xYZlLKIURktwuAbGCSyiZJBTBYf4da9MVJMSlE2NrFgYkBRSsnE5E8hXNf1e373iDO8znk9z3nOed7LFEV5vV6SJL3f73g8zhjjOC6VSnU6ncFgIAiC0WjUarV6vV6j0ZhMpuFwCKQsyyAy/ICMDPxoNOr3+0FYLpdATCaTUCjk9XptNhtTQ6fToenlciE+I2VkqOv1+ng8RvJ8PnGm02m32x0IBJxOZyQSCYfDyWSy3+/P5/Pz+fyvrKhB+jgrlQrP8/f7HYMEg0GDwQDBWCx2vV43m81qtWq1Wr1eDwB0/ynfbjfUuVwOaOicTieUxWIRZa1Wo3F2u50oitVqdTabNRqNnzKNul6vrVarz+d7PB4o2+22y+WaTqeSGoAdDof9fo+/EonExzASp2Gy2SwEkWAW6G+3W7IT3QE7Ho/NZrPb7eItGFktq0EPtlgs4Ar5STc4aSkQLBYLFslkMtif4Yr4JI72gMJMzF8ulz0eD/z7kkulEr2Z3W4vFAof8jdAJlw+nzebzfS2o9GIDMNeDocDl/hgMPkfL8mv3Wo9N4wAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 A5Z3N8iqF 7MP3L4y rtOQ"\n        title=""\n        src="/static/1*A5Z3N8iqF_7MP3L4y-rtOQ-65567b100f4cae8e379e8697a2683b2a-082ce.png"\n        srcset="/static/1*A5Z3N8iqF_7MP3L4y-rtOQ-65567b100f4cae8e379e8697a2683b2a-c7cb1.png 158w,\n/static/1*A5Z3N8iqF_7MP3L4y-rtOQ-65567b100f4cae8e379e8697a2683b2a-93041.png 315w,\n/static/1*A5Z3N8iqF_7MP3L4y-rtOQ-65567b100f4cae8e379e8697a2683b2a-082ce.png 630w,\n/static/1*A5Z3N8iqF_7MP3L4y-rtOQ-65567b100f4cae8e379e8697a2683b2a-58fd0.png 800w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*8i11xCrcmJLp43e6qlIaDw-2d7027ae3459aa553247e08549fa0f11-58fd0.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABpElEQVQoz22Ru87hURTFjwYPoPAOX6PwAAqdTiciGtFINBqNSlRCIhGFUit0EpVbgwKJWyKSQYIIcb+P2/zmf/LNFDOrOFl7n7332hdxvV5vtxvv5XI5nU6fzyeZTEYikY+C9/vNGwgEXC4X/Hw+XxRIIna73f1+/6kA8ng8LBaLwWCIRqOFQoGi4XBYCKHX65vNJoUIowr+yWQittstyriw+ctkMoQajcZcLtfr9ex2u1qt1mg0OD0ez+v1whkKhYrF4u9klFer1fP5lMn5fD6VSg0GA3ij0XA4HGazWavV6nQ6v99fq9VisZjJZKKp6XQq6IEaTEvDJPT7/Ww2K0f1+XxfCrxeb71en8/no9GoVCpVKpVut0u8IAjN8Xh8PB7hiUSCDtGHW61WlUqFGY/HMVkSLzNWq9X9fg8XUoSP4XB4OBzcbjfRTqeT8eTmMYPB4FvBcrksl8vr9VoeQny+wdj0nE6nW60WtTBxzmYzm83G8Oy10+nQrdSXkn+T/xyWg202G/bx4xuM2m63F4uFDJCZ/0mWYBmU4BAIskup9i9+AZIN3fQGIIayAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 8i11xCrcmJLp43e6qlIaDw"\n        title=""\n        src="/static/1*8i11xCrcmJLp43e6qlIaDw-2d7027ae3459aa553247e08549fa0f11-082ce.png"\n        srcset="/static/1*8i11xCrcmJLp43e6qlIaDw-2d7027ae3459aa553247e08549fa0f11-c7cb1.png 158w,\n/static/1*8i11xCrcmJLp43e6qlIaDw-2d7027ae3459aa553247e08549fa0f11-93041.png 315w,\n/static/1*8i11xCrcmJLp43e6qlIaDw-2d7027ae3459aa553247e08549fa0f11-082ce.png 630w,\n/static/1*8i11xCrcmJLp43e6qlIaDw-2d7027ae3459aa553247e08549fa0f11-58fd0.png 800w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*3KErRsdCyaBmAtlliHyDog-7123e71437ec84999c0c6fedd1ba9e27-58fd0.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABWElEQVQoz22SsaqCYBTHzaAn8C3a3aUHCFcdImhtbawQhCBwaegdhCYHl8CWdkEKEdxMiCS7gpmW3func69k3DMcj+f8f+ccv0/m+8/u93uapgjm83m32w3DMIqisixd122326PR6PF43G43yCqEocfz+UShKArEvu9zHDcYDGazWRAEnU6HYZjJZIISBJBBXIPRjwqILctqNptQ27YtSVKj0QA8nU4JzvO8Gv4LI1W8DHueTidN03a73WazwcKyLKPFdrutZkD8P4wAWx0OB1EUHcfB8p7nXa9XwzDW63WSJMR/wjAcCbU4n8+maZIOHusMh0Oe59EFn/Y5GWVkCaYtiO/3+7quQ3A8HlerFWRZlsHX4Go45lDjXq/XarVYlsVpLRYLZIDt93v4z6uqeLpJ+OVyqSiKqqqCIIzHY1S/Xvaur8F0GXEc46qr3ZDB6+Vyef89yH4AIyT77iDIluYAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 3KErRsdCyaBmAtlliHyDog"\n        title=""\n        src="/static/1*3KErRsdCyaBmAtlliHyDog-7123e71437ec84999c0c6fedd1ba9e27-082ce.png"\n        srcset="/static/1*3KErRsdCyaBmAtlliHyDog-7123e71437ec84999c0c6fedd1ba9e27-c7cb1.png 158w,\n/static/1*3KErRsdCyaBmAtlliHyDog-7123e71437ec84999c0c6fedd1ba9e27-93041.png 315w,\n/static/1*3KErRsdCyaBmAtlliHyDog-7123e71437ec84999c0c6fedd1ba9e27-082ce.png 630w,\n/static/1*3KErRsdCyaBmAtlliHyDog-7123e71437ec84999c0c6fedd1ba9e27-58fd0.png 800w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*rnin28MOTk0Iwz_1MUM7XA-2b9f9a6aad33121fae7a0aca3d3843cd-58fd0.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABgUlEQVQoz4VRuarCUBS8SH5BG//BLmIv2lnamspCBCvRwspWhLTWQhALrbW0EsWoGERcgopISFxwT1xi3uB9WMhbpghzuGdy5swht9vtcDicz2fDMMB1XbcsS9O08XhsvVCr1UajEcj1epUkSRTF9Xq9WCzu9zuZTqflctk0Tf0FkM1mE4lE4vH46XR6PB7BYNDlcnW7Xbwmk8l0Or3b7Xw+n6IoBN3H4xGT8Ybhz+czFosRQkKhUC6X6/V6TqcTpdvtLpVK7XZbVVU4nc1m8EKoN2jgCmIYrlarmUymUqnIssxxnN1uZxgmHA5PJpPVaoVhsENV32Kqx3c+nycSieVyCS4Igt/v93g82WwWSyIR2vPGp3gwGMBkKpUCZ1nWZrOhzOfzKPf7/T/ifr/v9XqLxSLCbDab2NPhcAQCAWx0uVzg+S/xcDjEJUBo8iCdTqdQKGBPhPyrGMBW9Xp9u91iCE0Ff6SCVqsVjUbfUf0gBniex3neRgAqbjQauPBH8xcb5vPVG3C1DgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 rnin28MOTk0Iwz 1MUM7XA"\n        title=""\n        src="/static/1*rnin28MOTk0Iwz_1MUM7XA-2b9f9a6aad33121fae7a0aca3d3843cd-082ce.png"\n        srcset="/static/1*rnin28MOTk0Iwz_1MUM7XA-2b9f9a6aad33121fae7a0aca3d3843cd-c7cb1.png 158w,\n/static/1*rnin28MOTk0Iwz_1MUM7XA-2b9f9a6aad33121fae7a0aca3d3843cd-93041.png 315w,\n/static/1*rnin28MOTk0Iwz_1MUM7XA-2b9f9a6aad33121fae7a0aca3d3843cd-082ce.png 630w,\n/static/1*rnin28MOTk0Iwz_1MUM7XA-2b9f9a6aad33121fae7a0aca3d3843cd-58fd0.png 800w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*ahYO-bp29DZ92gg40Q9uWQ-883f368655b6f4b73161ebc3a2336fab-58fd0.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABSElEQVQoz31RscqCUBgV0pZmN6dA6A18AEEyaAt8BCcbfINanbKIkNwaCwsdHIIeIFokszeohAjK0IrqPxDI35/9Z/j47rn3fOd8XOL5juv1ahhGq9WSJGk4HC6XS13XK5VKo9F4foBIu/v9jup5HkmSiqIcj8fNZlOr1SiKAkMQhOu66bNssWVZHMetViv0vV5PFMVqtUrTNMTtdvurGLhcLnAbj8e+7+Moy3Iul2MYxjRNTdNms9nj8ciODSAqquM4hUJhOp2ir9frxWIRQ2GI2IfDAWQ64k2cJEkURdvtluf5IAjATCYTpI3j+Hw+dzqdMAy/isHCfLfbLRaL1xbp1e12g/K/2C/z/X6/Xq9PpxOa+Xw+Go263a5t23+UGc6oCKmqarPZLJfL+Xwe+wuCgA//HTjbOQ3Z7/dZli2VSoPB4NPzhR8UjvBUZddFfgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 ahYO bp29DZ92gg40Q9uWQ"\n        title=""\n        src="/static/1*ahYO-bp29DZ92gg40Q9uWQ-883f368655b6f4b73161ebc3a2336fab-082ce.png"\n        srcset="/static/1*ahYO-bp29DZ92gg40Q9uWQ-883f368655b6f4b73161ebc3a2336fab-c7cb1.png 158w,\n/static/1*ahYO-bp29DZ92gg40Q9uWQ-883f368655b6f4b73161ebc3a2336fab-93041.png 315w,\n/static/1*ahYO-bp29DZ92gg40Q9uWQ-883f368655b6f4b73161ebc3a2336fab-082ce.png 630w,\n/static/1*ahYO-bp29DZ92gg40Q9uWQ-883f368655b6f4b73161ebc3a2336fab-58fd0.png 800w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*L36gycyI3fYfEPVhcaHPWA-951c80d4a6b759a4bddc36ee22ec7af8-58fd0.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABxUlEQVQoz2WSvctBcRTHfzGwiDKJyaBkuYNBBqN/wcumrKyK1d2EMiClpAxKKaJEFFYLkSiSRMr72/V2ny+/p2d5Tt17f+d3zuec7zldwvP89XrdbreNRkMqlQoEApPJVKvV7vf7YDCwWCxyuVwikRBCEMLb4XCMx2NE3+834TjufD6jRL/fl8lkWq22Xq8jgJtYLGaz2dxut1qtFovFQqEQcCAQeDwel8sFIKEf+Cjh8/larRYwuLfbTa/XI1upVBqNRo/HYzAYGIZpNptIQBTgB4YG8M/nE4d0Ou31eo/HI1yXy6VSqcA7nU5kj0ajSqXSbreBQNoHRkP0AUbFh8NhZNvt9v1+Dzcej8PNZrP817rdbrVa7XQ6s9nsVzaF4SA8mUwUCoVGozkcDnCBiUSiUqkEIWiOm2g0ajabl8sl1kzw0Jn/eMQSiQRthSZ+v/90OtHV7HY7q9Wq0+mm0ynyyev1gmBU5b4GIJPJbDYbHBDi/xmY9Xq9Wq0+ME0Cj/KYcz6f93o9zAZFw+EQyy+Xy/l8PpfLpVIpvBeLBWRiCoCE1sP24CM7mUxiSYVCAVuF+EgkEgqFgl9jWbZYLFJ19Ef4AdaEvZy/dlFYAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 L36gycyI3fYfEPVhcaHPWA"\n        title=""\n        src="/static/1*L36gycyI3fYfEPVhcaHPWA-951c80d4a6b759a4bddc36ee22ec7af8-082ce.png"\n        srcset="/static/1*L36gycyI3fYfEPVhcaHPWA-951c80d4a6b759a4bddc36ee22ec7af8-c7cb1.png 158w,\n/static/1*L36gycyI3fYfEPVhcaHPWA-951c80d4a6b759a4bddc36ee22ec7af8-93041.png 315w,\n/static/1*L36gycyI3fYfEPVhcaHPWA-951c80d4a6b759a4bddc36ee22ec7af8-082ce.png 630w,\n/static/1*L36gycyI3fYfEPVhcaHPWA-951c80d4a6b759a4bddc36ee22ec7af8-58fd0.png 800w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*6OnoHeZ9a_Pd3uIz_6eazw-2bfb7a8be0cd800da67d33355087187b-58fd0.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABsElEQVQoz1WRu89pURDFT6dFJHoqoRChlmh0GoVENFqFRCP+BBqPoNFpBI1CVEqvglIkxKMQEeL9fru/7+7cL7lT7LNnZq1Zs/aRvt/varWq1WqFQkGr1ep0OpfLRUr9/X5z7vf7aDRqNptVKpVMJpMkyWQyzedzWtL9fr9cLq/Xi8Tv99Oz2+3H4/F6vd5uN4qpVMrn81ksFqVSKf0Nq9U6mUwYLcF8PB7n8/nz+fR6Pbfb3Wq14AhmLBYDbTQa9Xq90+k0GAwKhSKZTNJC4If8fD7hswL83W5XqVTC4TBeQASDQbaFb7PZlssl00ulUrVaPZ1O4CXxEcEgCMViUaCFsXK5TBqJRLgzfTweNxqNTqczHA5/yEJZBO3FYiGXyx0OB4vxFtPpVK1Wp9NpTCLAiEwmo9Fo6vW6hNv1ei2UudNrNpter/dwODBUvAjis9mMVyAFlsvlPB5Pt9uVQGBPyIp/0263EaeOLBUIrPP9F9RJqXNKwslms9lut2yCSL/f//15v91sNsvjBQKBUCgEQNQlgWASW+Xzefzg4vt/gBsMBvF4PJFIjEYjsSDxBw1ryjgjWoHNAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 6OnoHeZ9a Pd3uIz 6eazw"\n        title=""\n        src="/static/1*6OnoHeZ9a_Pd3uIz_6eazw-2bfb7a8be0cd800da67d33355087187b-082ce.png"\n        srcset="/static/1*6OnoHeZ9a_Pd3uIz_6eazw-2bfb7a8be0cd800da67d33355087187b-c7cb1.png 158w,\n/static/1*6OnoHeZ9a_Pd3uIz_6eazw-2bfb7a8be0cd800da67d33355087187b-93041.png 315w,\n/static/1*6OnoHeZ9a_Pd3uIz_6eazw-2bfb7a8be0cd800da67d33355087187b-082ce.png 630w,\n/static/1*6OnoHeZ9a_Pd3uIz_6eazw-2bfb7a8be0cd800da67d33355087187b-58fd0.png 800w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*eozpsUwC0d8D3lXkL0zb9Q-ae5c2a22c2903b131826360160cfc8b7-58fd0.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABvElEQVQoz02Sy6upYRTGPxJtBsTEgIyYGihjMylzA5KZ4m/wHyhFUYoSU0ky2LnMkJTaRTKjlIk72/1yfse32+c89b3f21rrWetZa73C6/U6nU6coVDIbDZns9lKpZJKpfL5/OFwwHU8Hjk7nY7P59NoNHa7fT6fP59PKMLj8cC9Xq9tNptMJnO5XIlEIhqNxmKxzWZTq9XC4bDT6VSr1YIgSKXSj4+Pcrl8vV4hCufzmV+v11MoFEqlMhgMDgaD1xvtdtvj8ej1epPJZDQaYcrlclKk02lRr0DZ+/0+mUyQ3Ww2sYpauEQiEcjJZNLtdhsMBq1WS1nOXC6Hlxjhdrvt93t66Ha74/EYIUjChxakSiQSnU5nsVisVmuj0YjH4/V6vVQqDYdDIgVou91O7MHhcHi9XqyQW60WgpkQfKQGAgGxGigWi9Vq9e/A+C6Xy3a75eL3+4ljPNPplKTf3980wizo9vPzU4ykRqFQGI1GP2QxJQVnsxmhiFwulwRhJ6lKpWIR/X7//MZqtVosFiLrhwxonhRsiH7EYRKKJZPJMH+8dMfmufxS/pF/AY3KVPh6g10c3hAfxv/4A/Cgp1gRa9rYAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 eozpsUwC0d8D3lXkL0zb9Q"\n        title=""\n        src="/static/1*eozpsUwC0d8D3lXkL0zb9Q-ae5c2a22c2903b131826360160cfc8b7-082ce.png"\n        srcset="/static/1*eozpsUwC0d8D3lXkL0zb9Q-ae5c2a22c2903b131826360160cfc8b7-c7cb1.png 158w,\n/static/1*eozpsUwC0d8D3lXkL0zb9Q-ae5c2a22c2903b131826360160cfc8b7-93041.png 315w,\n/static/1*eozpsUwC0d8D3lXkL0zb9Q-ae5c2a22c2903b131826360160cfc8b7-082ce.png 630w,\n/static/1*eozpsUwC0d8D3lXkL0zb9Q-ae5c2a22c2903b131826360160cfc8b7-58fd0.png 800w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*kHebEdlCjoe-POqs8yKKJA-ac157072791c9c5a38778635b62b06f6-58fd0.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABpElEQVQoz2WRPavBYRjG/17jC5B8AIvFBzBYLLIoZaNksGAxKbtJeY3BIJNBkYGNhQjZbFIW5CVE3uL88tc5nXPuep6u53ru634VXq/X7XZrNpuxWCwYDPr9/kQi4fV6TSbTdrsdj8f5fD6bzcIbjUaXyxUIBOLx+Gq1QihwHo9Hr9crFAp6vV6j0dhstmq1Cj+bzTwej0qlUqvVgiDIZDJut9tdq9UOh8NHfL1eL5cLIJlM8h2NRqmFZyqVslqtTqeToFKplC8yr9drUfIjPp/P3KfTqd1u08JkMoH3+Xxk02q16XS6VCrR1HA4hMftl5jMYgie4XBYoVB0u11wKBTS6XS73Q68XC7L5XKj0aCuv2IoUVypVCwWy2KxANfrdcZDh2K2SCRit9s3m43Y5k/Z3/GofDqdAu73++uf4cMWiPURI3s+n7gej8f9fj+fz/mGB4xGo1arVSwWKYHOM5kMmC2IgQRxAJ1Ox+FwsFuDwWA2m3O5HJ3TLUtSKpUSiUQulzNtceYMgu1+xIPBgGXC4iS87RuIhgZG9jYA4+z3+wi/AGbQg2fxU9oDAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 kHebEdlCjoe POqs8yKKJA"\n        title=""\n        src="/static/1*kHebEdlCjoe-POqs8yKKJA-ac157072791c9c5a38778635b62b06f6-082ce.png"\n        srcset="/static/1*kHebEdlCjoe-POqs8yKKJA-ac157072791c9c5a38778635b62b06f6-c7cb1.png 158w,\n/static/1*kHebEdlCjoe-POqs8yKKJA-ac157072791c9c5a38778635b62b06f6-93041.png 315w,\n/static/1*kHebEdlCjoe-POqs8yKKJA-ac157072791c9c5a38778635b62b06f6-082ce.png 630w,\n/static/1*kHebEdlCjoe-POqs8yKKJA-ac157072791c9c5a38778635b62b06f6-58fd0.png 800w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>A few of the map projections available from the D3 Geo Projection library, because theyâ€™re visually interesting.</p>\n<p><a href="https://d3js.org/">D3.js</a> has a lot of useful utilities, with map projection and tile slice helpers amongst them, along with plenty of tools geared towards working with and generating SVG assets. Compared to the complexity of writing my own code, and the amount of things I donâ€™t understand about how to draw a map with code, D3 offers the tantalising promise of making things ludicrously simple.</p>\n<p>The downside to D3 is that I canâ€™t seem to make it work with Node.js. Yes, itâ€™s all still Javascript, but D3 is geared towards running in a browser and not on a server, so quite a few bits of code donâ€™t work as expected. All of my code so far has been server-side, but to make any progress it seems like I need to switch.</p>\n<p>Borrowing heavily from some examples from the D3 documentation Iâ€™m able to draw a map in the browser, one that uses GeoJSON data converted from the MVT formatted response extracted from the Mapbox API.</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*9sEbhAnfVeIzYDtjHyUnvQ-2d3c1fb84af750f94624ddde1a02b57c-74a12.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 54.199999999999996%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABMElEQVQoz22TBw7DMAwD/f8P5gfZe0+7OaEMUqAGBMuySFGK467rCsdxPDaOY5jnObDO83zi+MuyPD5r33czYuJx3ntztm2znQRIRUwcAgD/9nVdf/COIKZKKtD3fZimKeheBFLHGQxEUkrM6VKJEGIkoJA2Ab2BqCKubt6q3XtGCkopJG3bmtJhGKwAe5Zloa7r0HWdmXBgjFCzIqAPQXXOtF6WpRFAzq5zURS2o7hpGsM6zUIz1AhIYqEOIpTg06KIIYG8qioz1DsNUzPSl2NGaoU7tUyclqMoCnEcGzlkuqNlr6ehWaqIyKVK7w1CyFDJXZ7nRnibd7SCo3ckkD4ScVpllhhKwchHFQqTJPHM1N3Jnip3kk/T1BS9yQAQQwFEgMinMIQUu2fpvz+C/wAUslhnrfrn9AAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 9sEbhAnfVeIzYDtjHyUnvQ"\n        title=""\n        src="/static/1*9sEbhAnfVeIzYDtjHyUnvQ-2d3c1fb84af750f94624ddde1a02b57c-082ce.png"\n        srcset="/static/1*9sEbhAnfVeIzYDtjHyUnvQ-2d3c1fb84af750f94624ddde1a02b57c-c7cb1.png 158w,\n/static/1*9sEbhAnfVeIzYDtjHyUnvQ-2d3c1fb84af750f94624ddde1a02b57c-93041.png 315w,\n/static/1*9sEbhAnfVeIzYDtjHyUnvQ-2d3c1fb84af750f94624ddde1a02b57c-082ce.png 630w,\n/static/1*9sEbhAnfVeIzYDtjHyUnvQ-2d3c1fb84af750f94624ddde1a02b57c-c4006.png 945w,\n/static/1*9sEbhAnfVeIzYDtjHyUnvQ-2d3c1fb84af750f94624ddde1a02b57c-85e68.png 1260w,\n/static/1*9sEbhAnfVeIzYDtjHyUnvQ-2d3c1fb84af750f94624ddde1a02b57c-38b38.png 1890w,\n/static/1*9sEbhAnfVeIzYDtjHyUnvQ-2d3c1fb84af750f94624ddde1a02b57c-74a12.png 2000w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>GeoJSON generated from Mapbox Vector Tiles, and rendered as SVG byÂ D3.js</p>\n<p>The output is an SVG image containing path elements and basic shapes, but at the moment itâ€™s just a jumbled mess of geography, completely free of any styling to make the map actually readable. To make anything visible, Iâ€™ve added the some basic CSS styles, which the generated SVG inherits.</p>\n<p>path {<br>\nfill: none;<br>\nstroke: #000;<br>\nstroke-linejoin: round;<br>\nstroke-linecap: round;<br>\nstroke-width: .5px;<br>\n}</p>\n<h4>Rendering a half-decent map</h4>\n<p>Itâ€™s getting tantalisingly close, now that I can start recognising geography. But thereâ€™s also a lot of noise and unwanted information, and no weighting or visual indicators of what the map actually contains.</p>\n<p>Fortunately the GeoJSON data still contains this information, and with a few tweaks to the D3 code I can generate SVG shapes with classes that reflect their type, and then start expanding the CSS stylesheet with styles like these:</p>\n<p>.river,.canal {<br>\nstroke-width: 2px;<br>\n}<br>\n.stream<em>intermittent,.track,.fence {<br>\nstroke-dasharray: 3, 3;<br>\n}<br>\n.river,.canal,.stream,.stream</em>intermittent,.drain,.ditch {<br>\nstroke: #1C8FE8;<br>\n}<br>\n.major_rail {<br>\nstroke: #F45B69;<br>\n}</p>\n<p>With enough styles and tweaking, I can eventually produce an output map thatâ€™s way more aesthetically pleasing, like this:</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*3TpJHg5VKhNCeK_y3TkZrQ-41810cd5aa4da215be0a57782e710ed3-74a12.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 54.199999999999996%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACFUlEQVQozz1TyW4TQRCdX3L39DY9+2Y7DiRyLsESloXEJUoOkRAERwLx4/N41TYcSurprnpLVU2W5zmMuYScXVHCeQ+1WsFaC+sclCugjYeLFfMMtM6hlIKxDtrH651K50xrDZ0b5NZD2wBdNHAhEjgilmUi0MYhZ14uhcYyn4BSR5Dcl7wnsbwRJ8vJosiufJ2UKF4qAoeqgQ0l3wSM7FQkDi7qVhAhnuqNC0mIoRt5y8SaIoOytCWJLBRmsRGrGqEoYALDh9SCEHy6q+saTdOgZI6QSstEeZZsph65i4LUU5MUSHFVVaiaFqFmhJCA+mFA27YEq1DWDVaCoXSqycS/F3tkV1dbAigh3zFGNKKmZrGcqUrA+mnC9v4+ERr2vN7ccg6WltmzdpoxktVfpyugPoRkP8QyAXTjhG6eLyqbGsN6jYE1Jd8LARxm2KJGVrUdxnFE3/epUGQ7NttzygIsEUjUE2z6eAdPFc0wYb29ocoZw90e2/0DQTkYGco8z0tBKzIIkf/PsqyFkb28gjckM8xZsaiZbzBud9g/v+LL7z/49P2Mh6cXfDgclqzrOpniIuujr3ZF5f+9437mtOLqHmXbw0YOp2q5UhG7r084/Djj8fUbjm/n5fTzjGzouyVOG5Sb22Xc7ZhYEJRg6S/gYncTe1OlBfaRa9KNsCUnu1K4/XzE8f0XTuf35fT2hsfnl+UvNTF23NRlN+IAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 3TpJHg5VKhNCeK y3TkZrQ"\n        title=""\n        src="/static/1*3TpJHg5VKhNCeK_y3TkZrQ-41810cd5aa4da215be0a57782e710ed3-082ce.png"\n        srcset="/static/1*3TpJHg5VKhNCeK_y3TkZrQ-41810cd5aa4da215be0a57782e710ed3-c7cb1.png 158w,\n/static/1*3TpJHg5VKhNCeK_y3TkZrQ-41810cd5aa4da215be0a57782e710ed3-93041.png 315w,\n/static/1*3TpJHg5VKhNCeK_y3TkZrQ-41810cd5aa4da215be0a57782e710ed3-082ce.png 630w,\n/static/1*3TpJHg5VKhNCeK_y3TkZrQ-41810cd5aa4da215be0a57782e710ed3-c4006.png 945w,\n/static/1*3TpJHg5VKhNCeK_y3TkZrQ-41810cd5aa4da215be0a57782e710ed3-85e68.png 1260w,\n/static/1*3TpJHg5VKhNCeK_y3TkZrQ-41810cd5aa4da215be0a57782e710ed3-38b38.png 1890w,\n/static/1*3TpJHg5VKhNCeK_y3TkZrQ-41810cd5aa4da215be0a57782e710ed3-74a12.png 2000w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>The same SVG as before, with some better CSS stylesÂ attached</p>\n<h4>Plotting a routeÂ overlay</h4>\n<p>Now that Iâ€™ve got a decent map, I can get on to plotting my route data from Fitbit on top of it. Refreshingly thatâ€™s actually turned out to be quite easy, no small thanks to everything Iâ€™ve learnt so far in this process.</p>\n<p>If you recall, before I even looked at drawing the underlying map Iâ€™d already extracted a list of geolocation data points from the TCX file that I got from Fitbit. With the help of D3 itâ€™s a simple process to create a new path element from those data points and insert it into the existing SVG map, give it a custom class and styles, just like the map has classes for roads and rivers, and just like that, I have my route data plotted as an overlay. âœ¨</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-74a12.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 630px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 54.199999999999996%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACG0lEQVQozz1TyW7bMBDVL5kUF4nUvjheCgfOJTXQICjQS5AcAhRt6gAt+uN6fUM7PQiWyZm3zSjL8xzGXB55d2WE8x5qtYK1FtY5KFdCGw8XKtYZaJ1DKQVjHbQP1zOV3jOtNXRukFsPbQvosoErAoEDQoyJQBuHnHW5NBrLegJKH0FyH3lOYrkjTpaTRZFd+TopUTxUBC6qBraIWCUwslOROLioW0GEeKo3rkhCDN3IXSbWFBmUpS0pZKMwi41Q1SjKksAllRQpgqLw6ayuazRNg8gaRVKJTJRnyWbKyF0UpExNUuCKAusYMNUNyrpJ/ysC9cOAtm0JViHyfCUYSqeeTPx7sUd2dbUlgJKJYlEXSmyZ5Z6/M9V1VNUQrJ8mbG5vURHUMPP6Zs85WFpmZu00YySrv05XQD3VCEEIAWuCDOOIPZ+KNXVTY1yvMbAnhohSAIcZtqyRVW2HkYV93ycbySrD9pzyRwRC1M8kPRx4Z9EME9abLVXOGA5HbI53BOVgZCjzPC8lVcggRP6HZVkLI3t5BRcywxrFpmbeYtzscHx+xdc/f/H5xxl3Ty/4dDotWdd1zKBcZH301a6o/L933M+cVlzdI7Y9bGi5Ui0nH7D79oTTzzPuX7/j4e28PP46Ixv6bgnTDeLNfhl3u8uK5ARLXwEXu5uYTZUW2AeuSTfCRk52pbD/8oCH9994PL8vj29vuH9+Wf4BipF3D80oaoMAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="1 wVcjl TBtsD5N3HNWU6h9A"\n        title=""\n        src="/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-082ce.png"\n        srcset="/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-c7cb1.png 158w,\n/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-93041.png 315w,\n/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-082ce.png 630w,\n/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-c4006.png 945w,\n/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-85e68.png 1260w,\n/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-38b38.png 1890w,\n/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-74a12.png 2000w"\n        sizes="(max-width: 630px) 100vw, 630px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>The â€˜finalâ€™ generated map, complete with route data exported fromÂ Fitbit</p>\n<h3>Whatâ€™s next?</h3>\n<p>This is as far as Iâ€™ve got with this little side project. My original objective of having something thatâ€™s print-worthy still remains, but the visuals are still a long way off where Iâ€™d like them to be for the final poster.</p>\n<p>Iconography and labels are my next big challenges, I think. Plotting a few icons on the map sounds easy enough, but Iâ€™d like to be able to automatically, intelligently annotate any route I upload. Something like that sounds complicated thoughâ€Šâ€”â€Šit would require going a step further and doing some kind of shape hitbox detection to avoid overlapping icons with the route, or with other icons. And labels. Iâ€™d never quite appreciated how complex labelling a road or a point of interest would be on a map, if you want to avoid overlapping labels or if you want labels to follow a road. This is going to take some effort to progress further!</p>\n<hr>\n<p>Thatâ€™s the end of it for now. Iâ€™ve paused this project in favour of some other new and shiny side-project ideas, but I hope that at some point in the future I hope to come back to this project, finish it and get my own lovingly-generated poster printed.</p>',
frontmatter:{title:"Generating Run Maps with Node.js",date:"March 26, 2018",tags:["Maps","Side Project","Mapbox","Nodejs","D3js"],url:"https://medium.com/@psyked/generating-run-maps-with-node-js-52738014d3dc",image:{childImageSharp:{sizes:{base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACG0lEQVQozz1TyW7bMBDVL5kUF4nUvjheCgfOJTXQICjQS5AcAhRt6gAt+uN6fUM7PQiWyZm3zSjL8xzGXB55d2WE8x5qtYK1FtY5KFdCGw8XKtYZaJ1DKQVjHbQP1zOV3jOtNXRukFsPbQvosoErAoEDQoyJQBuHnHW5NBrLegJKH0FyH3lOYrkjTpaTRZFd+TopUTxUBC6qBraIWCUwslOROLioW0GEeKo3rkhCDN3IXSbWFBmUpS0pZKMwi41Q1SjKksAllRQpgqLw6ayuazRNg8gaRVKJTJRnyWbKyF0UpExNUuCKAusYMNUNyrpJ/ysC9cOAtm0JViHyfCUYSqeeTPx7sUd2dbUlgJKJYlEXSmyZ5Z6/M9V1VNUQrJ8mbG5vURHUMPP6Zs85WFpmZu00YySrv05XQD3VCEEIAWuCDOOIPZ+KNXVTY1yvMbAnhohSAIcZtqyRVW2HkYV93ycbySrD9pzyRwRC1M8kPRx4Z9EME9abLVXOGA5HbI53BOVgZCjzPC8lVcggRP6HZVkLI3t5BRcywxrFpmbeYtzscHx+xdc/f/H5xxl3Ty/4dDotWdd1zKBcZH301a6o/L933M+cVlzdI7Y9bGi5Ui0nH7D79oTTzzPuX7/j4e28PP46Ixv6bgnTDeLNfhl3u8uK5ARLXwEXu5uYTZUW2AeuSTfCRk52pbD/8oCH9994PL8vj29vuH9+Wf4BipF3D80oaoMAAAAASUVORK5CYII=",aspectRatio:1.845018450184502,src:"/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-7a72d.png",srcSet:"/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-8baea.png 158w,\n/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-69705.png 315w,\n/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-7a72d.png 630w,\n/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-514af.png 945w,\n/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-6eb3d.png 1260w,\n/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-bf598.png 1890w,\n/static/1*wVcjl_TBtsD5N3HNWU6h9A-160e6c3e839cc71d93ca702af74b2ec3-514ab.png 2000w",sizes:"(max-width: 630px) 100vw, 630px"}}},description:"Hacking away at the Mapbox and Fitbit data APIs"}}},pathContext:{prev:{frontmatter:{path:"/blog/duotone-version-2/",tags:["Medium","Software Development","Side Project","Duotone"],title:"Duotone: Version 2",date:"2018-03-20T23:01:53.855Z",description:"Refactoring and enhancing an MVP",image:{childImageSharp:null}}},next:{frontmatter:{path:"/blog/openfaas-like-lamba-but-open/",tags:["agileontap","openfaas","docker"],title:"OpenFaaS: Like AWS Lambda, but Open Source and built on top of Docker",date:"2018-03-26T21:55:23.000Z",description:null,image:null}}}}}});
//# sourceMappingURL=path---blog-generating-run-maps-with-node-js-ea83a34d3cf618e89d7c.js.map